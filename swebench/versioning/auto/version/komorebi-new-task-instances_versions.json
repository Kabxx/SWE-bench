[
    {
        "repo": "LGUG2Z/komorebi",
        "pull_number": 756,
        "instance_id": "LGUG2Z__komorebi-756",
        "issue_numbers": [
            "696"
        ],
        "base_commit": "311e37c8a2a9f212ebbc784cc26d1187f4547bb6",
        "patch": "diff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -351,9 +351,9 @@ checksum = \"0d6ef0072f8a535281e4876be788938b528e9a1d43900b82c2569af7da799125\"\n \n [[package]]\n name = \"either\"\n-version = \"1.10.0\"\n+version = \"1.11.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"11157ac094ffbdde99aa67b23417ebdd801842852b500e395a45a9c0aac03e4a\"\n+checksum = \"a47c1c47d2f5964e29c61246e81db715514cd532db6b5116a25ea3c03d6780a2\"\n \n [[package]]\n name = \"encoding_rs\"\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -1039,11 +1039,11 @@ dependencies = [\n \n [[package]]\n name = \"miow\"\n-version = \"0.5.0\"\n+version = \"0.6.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"52ffbca2f655e33c08be35d87278e5b18b89550a37dbd598c20db92f6a471123\"\n+checksum = \"359f76430b20a79f9e20e115b3428614e654f04fab314482fc0fda0ebd3c6044\"\n dependencies = [\n- \"windows-sys 0.42.0\",\n+ \"windows-sys 0.48.0\",\n ]\n \n [[package]]\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2428,7 +2428,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"e48a53791691ab099e5e2ad123536d0fff50652600abaf43bbf952894110d0be\"\n dependencies = [\n  \"windows-core 0.52.0\",\n- \"windows-targets 0.52.4\",\n+ \"windows-targets 0.52.5\",\n ]\n \n [[package]]\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2440,7 +2440,7 @@ dependencies = [\n  \"windows-core 0.54.0\",\n  \"windows-implement\",\n  \"windows-interface\",\n- \"windows-targets 0.52.4\",\n+ \"windows-targets 0.52.5\",\n ]\n \n [[package]]\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2449,7 +2449,7 @@ version = \"0.52.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"33ab640c8d7e35bf8ba19b884ba838ceb4fba93a4e8c65a9059d08afcfc683d9\"\n dependencies = [\n- \"windows-targets 0.52.4\",\n+ \"windows-targets 0.52.5\",\n ]\n \n [[package]]\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2459,7 +2459,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"12661b9c89351d684a50a8a643ce5f608e20243b9fb84687800163429f161d65\"\n dependencies = [\n  \"windows-result\",\n- \"windows-targets 0.52.4\",\n+ \"windows-targets 0.52.5\",\n ]\n \n [[package]]\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2486,26 +2486,11 @@ dependencies = [\n \n [[package]]\n name = \"windows-result\"\n-version = \"0.1.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"cd19df78e5168dfb0aedc343d1d1b8d422ab2db6756d2dc3fef75035402a3f64\"\n-dependencies = [\n- \"windows-targets 0.52.4\",\n-]\n-\n-[[package]]\n-name = \"windows-sys\"\n-version = \"0.42.0\"\n+version = \"0.1.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"5a3e1820f08b8513f676f7ab6c1f99ff312fb97b553d30ff4dd86f9f15728aa7\"\n+checksum = \"749f0da9cc72d82e600d8d2e44cadd0b9eedb9038f71a1c58556ac1c5791813b\"\n dependencies = [\n- \"windows_aarch64_gnullvm 0.42.2\",\n- \"windows_aarch64_msvc 0.42.2\",\n- \"windows_i686_gnu 0.42.2\",\n- \"windows_i686_msvc 0.42.2\",\n- \"windows_x86_64_gnu 0.42.2\",\n- \"windows_x86_64_gnullvm 0.42.2\",\n- \"windows_x86_64_msvc 0.42.2\",\n+ \"windows-targets 0.52.5\",\n ]\n \n [[package]]\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2523,7 +2508,7 @@ version = \"0.52.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"282be5f36a8ce781fad8c8ae18fa3f9beff57ec1b52cb3de0789201425d9a33d\"\n dependencies = [\n- \"windows-targets 0.52.4\",\n+ \"windows-targets 0.52.5\",\n ]\n \n [[package]]\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2543,25 +2528,20 @@ dependencies = [\n \n [[package]]\n name = \"windows-targets\"\n-version = \"0.52.4\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"7dd37b7e5ab9018759f893a1952c9420d060016fc19a472b4bb20d1bdd694d1b\"\n+checksum = \"6f0713a46559409d202e70e28227288446bf7841d3211583a4b53e3f6d96e7eb\"\n dependencies = [\n- \"windows_aarch64_gnullvm 0.52.4\",\n- \"windows_aarch64_msvc 0.52.4\",\n- \"windows_i686_gnu 0.52.4\",\n- \"windows_i686_msvc 0.52.4\",\n- \"windows_x86_64_gnu 0.52.4\",\n- \"windows_x86_64_gnullvm 0.52.4\",\n- \"windows_x86_64_msvc 0.52.4\",\n+ \"windows_aarch64_gnullvm 0.52.5\",\n+ \"windows_aarch64_msvc 0.52.5\",\n+ \"windows_i686_gnu 0.52.5\",\n+ \"windows_i686_gnullvm\",\n+ \"windows_i686_msvc 0.52.5\",\n+ \"windows_x86_64_gnu 0.52.5\",\n+ \"windows_x86_64_gnullvm 0.52.5\",\n+ \"windows_x86_64_msvc 0.52.5\",\n ]\n \n-[[package]]\n-name = \"windows_aarch64_gnullvm\"\n-version = \"0.42.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"597a5118570b68bc08d8d59125332c54f1ba9d9adeedeef5b99b02ba2b0698f8\"\n-\n [[package]]\n name = \"windows_aarch64_gnullvm\"\n version = \"0.48.5\"\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2570,15 +2550,9 @@ checksum = \"2b38e32f0abccf9987a4e3079dfb67dcd799fb61361e53e2882c3cbaf0d905d8\"\n \n [[package]]\n name = \"windows_aarch64_gnullvm\"\n-version = \"0.52.4\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"bcf46cf4c365c6f2d1cc93ce535f2c8b244591df96ceee75d8e83deb70a9cac9\"\n-\n-[[package]]\n-name = \"windows_aarch64_msvc\"\n-version = \"0.42.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"e08e8864a60f06ef0d0ff4ba04124db8b0fb3be5776a5cd47641e942e58c4d43\"\n+checksum = \"7088eed71e8b8dda258ecc8bac5fb1153c5cffaf2578fc8ff5d61e23578d3263\"\n \n [[package]]\n name = \"windows_aarch64_msvc\"\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2588,15 +2562,9 @@ checksum = \"dc35310971f3b2dbbf3f0690a219f40e2d9afcf64f9ab7cc1be722937c26b4bc\"\n \n [[package]]\n name = \"windows_aarch64_msvc\"\n-version = \"0.52.4\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"da9f259dd3bcf6990b55bffd094c4f7235817ba4ceebde8e6d11cd0c5633b675\"\n-\n-[[package]]\n-name = \"windows_i686_gnu\"\n-version = \"0.42.2\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c61d927d8da41da96a81f029489353e68739737d3beca43145c8afec9a31a84f\"\n+checksum = \"9985fd1504e250c615ca5f281c3f7a6da76213ebd5ccc9561496568a2752afb6\"\n \n [[package]]\n name = \"windows_i686_gnu\"\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2606,15 +2574,15 @@ checksum = \"a75915e7def60c94dcef72200b9a8e58e5091744960da64ec734a6c6e9b3743e\"\n \n [[package]]\n name = \"windows_i686_gnu\"\n-version = \"0.52.4\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"b474d8268f99e0995f25b9f095bc7434632601028cf86590aea5c8a5cb7801d3\"\n+checksum = \"88ba073cf16d5372720ec942a8ccbf61626074c6d4dd2e745299726ce8b89670\"\n \n [[package]]\n-name = \"windows_i686_msvc\"\n-version = \"0.42.2\"\n+name = \"windows_i686_gnullvm\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"44d840b6ec649f480a41c8d80f9c65108b92d89345dd94027bfe06ac444d1060\"\n+checksum = \"87f4261229030a858f36b459e748ae97545d6f1ec60e5e0d6a3d32e0dc232ee9\"\n \n [[package]]\n name = \"windows_i686_msvc\"\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2624,15 +2592,9 @@ checksum = \"8f55c233f70c4b27f66c523580f78f1004e8b5a8b659e05a4eb49d4166cca406\"\n \n [[package]]\n name = \"windows_i686_msvc\"\n-version = \"0.52.4\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"1515e9a29e5bed743cb4415a9ecf5dfca648ce85ee42e15873c3cd8610ff8e02\"\n-\n-[[package]]\n-name = \"windows_x86_64_gnu\"\n-version = \"0.42.2\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"8de912b8b8feb55c064867cf047dda097f92d51efad5b491dfb98f6bbb70cb36\"\n+checksum = \"db3c2bf3d13d5b658be73463284eaf12830ac9a26a90c717b7f771dfe97487bf\"\n \n [[package]]\n name = \"windows_x86_64_gnu\"\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2642,15 +2604,9 @@ checksum = \"53d40abd2583d23e4718fddf1ebec84dbff8381c07cae67ff7768bbf19c6718e\"\n \n [[package]]\n name = \"windows_x86_64_gnu\"\n-version = \"0.52.4\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"5eee091590e89cc02ad514ffe3ead9eb6b660aedca2183455434b93546371a03\"\n-\n-[[package]]\n-name = \"windows_x86_64_gnullvm\"\n-version = \"0.42.2\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"26d41b46a36d453748aedef1486d5c7a85db22e56aff34643984ea85514e94a3\"\n+checksum = \"4e4246f76bdeff09eb48875a0fd3e2af6aada79d409d33011886d3e1581517d9\"\n \n [[package]]\n name = \"windows_x86_64_gnullvm\"\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2660,15 +2616,9 @@ checksum = \"0b7b52767868a23d5bab768e390dc5f5c55825b6d30b86c844ff2dc7414044cc\"\n \n [[package]]\n name = \"windows_x86_64_gnullvm\"\n-version = \"0.52.4\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"77ca79f2451b49fa9e2af39f0747fe999fcda4f5e241b2898624dca97a1f2177\"\n-\n-[[package]]\n-name = \"windows_x86_64_msvc\"\n-version = \"0.42.2\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"9aec5da331524158c6d1a4ac0ab1541149c0b9505fde06423b02f5ef0106b9f0\"\n+checksum = \"852298e482cd67c356ddd9570386e2862b5673c85bd5f88df9ab6802b334c596\"\n \n [[package]]\n name = \"windows_x86_64_msvc\"\ndiff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -2678,9 +2628,9 @@ checksum = \"ed94fce61571a4006852b7389a063ab983c02eb1bb37b47f8272ce92d06d9538\"\n \n [[package]]\n name = \"windows_x86_64_msvc\"\n-version = \"0.52.4\"\n+version = \"0.52.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"32b752e52a2da0ddfbdbcc6fceadfeede4c939ed16d13e648833a61dfb611ed8\"\n+checksum = \"bec47e5bfd1bff0eeaf6d8b485cc1074891a197ab4225d504cb7a1ab88b02bf0\"\n \n [[package]]\n name = \"winput\"\ndiff --git a/komorebi/Cargo.toml b/komorebi/Cargo.toml\n--- a/komorebi/Cargo.toml\n+++ b/komorebi/Cargo.toml\n@@ -24,7 +24,7 @@ getset = \"0.1\"\n hex_color = { version = \"3\", features = [\"serde\"] }\n hotwatch = \"0.5\"\n lazy_static = \"1\"\n-miow = \"0.5\"\n+miow = \"0.6\"\n nanoid = \"0.4\"\n net2 = \"0.2\"\n os_info = \"3.8\"\n",
        "test_patch": "diff --git a/Cargo.lock b/Cargo.lock\n--- a/Cargo.lock\n+++ b/Cargo.lock\n@@ -142,9 +142,9 @@ checksum = \"514de17de45fdb8dc022b1a7975556c53c86f9f0aa5f534b98977b171857c2c9\"\n \n [[package]]\n name = \"cc\"\n-version = \"1.0.92\"\n+version = \"1.0.94\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"2678b2e3449475e95b0aa6f9b506a28e61b3dc8996592b983695e8ebb58a8b41\"\n+checksum = \"17f6e324229dc011159fcc089755d1e2e216a90d43a7dea6853ca740b84f35e7\"\n \n [[package]]\n name = \"cfg-if\"\n",
        "problem_statement": "chore(komorebi): update miow dependency\nThis cleans up having a second copy of windows-sys at a different version.\n",
        "hints_text": "",
        "created_at": "2024-04-14T04:19:13Z"
    },
    {
        "repo": "LGUG2Z/komorebi",
        "pull_number": 678,
        "instance_id": "LGUG2Z__komorebi-678",
        "issue_numbers": [
            "574"
        ],
        "base_commit": "fd57d32bb5b99279a9ecfbfce6b10b8280fbf64a",
        "patch": "diff --git a/komorebi-core/src/arrangement.rs b/komorebi-core/src/arrangement.rs\n--- a/komorebi-core/src/arrangement.rs\n+++ b/komorebi-core/src/arrangement.rs\n@@ -135,7 +135,7 @@ impl Arrangement for DefaultLayout {\n \n         dimensions\n             .iter_mut()\n-            .for_each(|l| l.add_padding(container_padding));\n+            .for_each(|l| l.add_padding(container_padding.unwrap_or_default()));\n \n         dimensions\n     }\ndiff --git a/komorebi-core/src/arrangement.rs b/komorebi-core/src/arrangement.rs\n--- a/komorebi-core/src/arrangement.rs\n+++ b/komorebi-core/src/arrangement.rs\n@@ -258,7 +258,7 @@ impl Arrangement for CustomLayout {\n \n         dimensions\n             .iter_mut()\n-            .for_each(|l| l.add_padding(container_padding));\n+            .for_each(|l| l.add_padding(container_padding.unwrap_or_default()));\n \n         dimensions\n     }\ndiff --git a/komorebi-core/src/rect.rs b/komorebi-core/src/rect.rs\n--- a/komorebi-core/src/rect.rs\n+++ b/komorebi-core/src/rect.rs\n@@ -27,13 +27,20 @@ impl From<RECT> for Rect {\n }\n \n impl Rect {\n-    pub fn add_padding(&mut self, padding: Option<i32>) {\n-        if let Some(padding) = padding {\n-            self.left += padding;\n-            self.top += padding;\n-            self.right -= padding * 2;\n-            self.bottom -= padding * 2;\n-        }\n+    /// decrease the size of self by the padding amount.\n+    pub fn add_padding(&mut self, padding: i32) {\n+        self.left += padding;\n+        self.top += padding;\n+        self.right -= padding * 2;\n+        self.bottom -= padding * 2;\n+    }\n+\n+    /// increase the size of self by the margin amount.\n+    pub fn add_margin(&mut self, margin: i32) {\n+        self.left -= margin;\n+        self.top -= margin;\n+        self.right += margin * 2;\n+        self.bottom += margin * 2;\n     }\n \n     #[must_use]\ndiff --git a/komorebi-core/src/rect.rs b/komorebi-core/src/rect.rs\n--- a/komorebi-core/src/rect.rs\n+++ b/komorebi-core/src/rect.rs\n@@ -43,4 +50,14 @@ impl Rect {\n             && point.1 >= self.top\n             && point.1 <= self.top + self.bottom\n     }\n+\n+    #[must_use]\n+    pub const fn scale(&self, system_dpi: i32, rect_dpi: i32) -> Rect {\n+        Rect {\n+            left: (self.left * rect_dpi) / system_dpi,\n+            top: (self.top * rect_dpi) / system_dpi,\n+            right: (self.right * rect_dpi) / system_dpi,\n+            bottom: (self.bottom * rect_dpi) / system_dpi,\n+        }\n+    }\n }\ndiff --git a/komorebi/src/border.rs b/komorebi/src/border.rs\n--- a/komorebi/src/border.rs\n+++ b/komorebi/src/border.rs\n@@ -1,5 +1,4 @@\n use std::sync::atomic::Ordering;\n-use std::time::Duration;\n \n use color_eyre::Result;\n use windows::core::PCWSTR;\ndiff --git a/komorebi/src/border.rs b/komorebi/src/border.rs\n--- a/komorebi/src/border.rs\n+++ b/komorebi/src/border.rs\n@@ -12,19 +11,14 @@ use windows::Win32::UI::WindowsAndMessaging::CS_VREDRAW;\n use windows::Win32::UI::WindowsAndMessaging::MSG;\n use windows::Win32::UI::WindowsAndMessaging::WNDCLASSW;\n \n-use komorebi_core::Rect;\n-\n-use crate::window::should_act;\n use crate::window::Window;\n use crate::windows_callbacks;\n use crate::WindowsApi;\n use crate::BORDER_HWND;\n use crate::BORDER_OFFSET;\n-use crate::BORDER_OVERFLOW_IDENTIFIERS;\n use crate::BORDER_RECT;\n-use crate::REGEX_IDENTIFIERS;\n+use crate::BORDER_WIDTH;\n use crate::TRANSPARENCY_COLOUR;\n-use crate::WINDOWS_11;\n \n #[derive(Debug, Clone, Copy)]\n pub struct Border {\ndiff --git a/komorebi/src/border.rs b/komorebi/src/border.rs\n--- a/komorebi/src/border.rs\n+++ b/komorebi/src/border.rs\n@@ -68,7 +62,6 @@ impl Border {\n             unsafe {\n                 while GetMessageW(&mut message, border.hwnd(), 0, 0).into() {\n                     DispatchMessageW(&message);\n-                    std::thread::sleep(Duration::from_millis(10));\n                 }\n             }\n \ndiff --git a/komorebi/src/border.rs b/komorebi/src/border.rs\n--- a/komorebi/src/border.rs\n+++ b/komorebi/src/border.rs\n@@ -82,10 +75,6 @@ impl Border {\n \n         BORDER_HWND.store(hwnd.0, Ordering::SeqCst);\n \n-        if *WINDOWS_11 {\n-            WindowsApi::round_corners(hwnd.0)?;\n-        }\n-\n         Ok(())\n     }\n \ndiff --git a/komorebi/src/border.rs b/komorebi/src/border.rs\n--- a/komorebi/src/border.rs\n+++ b/komorebi/src/border.rs\n@@ -100,7 +89,6 @@ impl Border {\n     pub fn set_position(\n         self,\n         window: Window,\n-        invisible_borders: &Rect,\n         activate: bool,\n     ) -> Result<()> {\n         if self.hwnd == 0 {\ndiff --git a/komorebi/src/border.rs b/komorebi/src/border.rs\n--- a/komorebi/src/border.rs\n+++ b/komorebi/src/border.rs\n@@ -111,38 +99,10 @@ impl Border {\n             }\n \n             let mut rect = WindowsApi::window_rect(window.hwnd())?;\n-            rect.top -= invisible_borders.bottom;\n-            rect.bottom += invisible_borders.bottom;\n-\n-            let border_overflows = BORDER_OVERFLOW_IDENTIFIERS.lock();\n-            let regex_identifiers = REGEX_IDENTIFIERS.lock();\n-\n-            let title = &window.title()?;\n-            let exe_name = &window.exe()?;\n-            let class = &window.class()?;\n-\n-            let should_expand_border = should_act(\n-                title,\n-                exe_name,\n-                class,\n-                &border_overflows,\n-                &regex_identifiers,\n-            );\n-\n-            if should_expand_border {\n-                rect.left -= invisible_borders.left;\n-                rect.top -= invisible_borders.top;\n-                rect.right += invisible_borders.right;\n-                rect.bottom += invisible_borders.bottom;\n-            }\n+            rect.add_padding(-BORDER_OFFSET.load(Ordering::SeqCst));\n \n-            let border_offset = BORDER_OFFSET.lock();\n-            if let Some(border_offset) = *border_offset {\n-                rect.left -= border_offset.left;\n-                rect.top -= border_offset.top;\n-                rect.right += border_offset.right;\n-                rect.bottom += border_offset.bottom;\n-            }\n+            let border_width = BORDER_WIDTH.load(Ordering::SeqCst);\n+            rect.add_margin(border_width);\n \n             *BORDER_RECT.lock() = rect;\n \ndiff --git a/komorebi/src/lib.rs b/komorebi/src/lib.rs\n--- a/komorebi/src/lib.rs\n+++ b/komorebi/src/lib.rs\n@@ -191,8 +191,7 @@ lazy_static! {\n     static ref BORDER_RECT: Arc<Mutex<Rect>> =\n         Arc::new(Mutex::new(Rect::default()));\n \n-    static ref BORDER_OFFSET: Arc<Mutex<Option<Rect>>> =\n-        Arc::new(Mutex::new(None));\n+    static ref BORDER_OFFSET: AtomicI32 = Default::default();\n \n     // Use app-specific titlebar removal options where possible\n     // eg. Windows Terminal, IntelliJ IDEA, Firefox\ndiff --git a/komorebi/src/monitor.rs b/komorebi/src/monitor.rs\n--- a/komorebi/src/monitor.rs\n+++ b/komorebi/src/monitor.rs\n@@ -195,7 +195,6 @@ impl Monitor {\n     pub fn update_focused_workspace(\n         &mut self,\n         offset: Option<Rect>,\n-        invisible_borders: &Rect,\n     ) -> Result<()> {\n         let work_area = *self.work_area_size();\n         let offset = if self.work_area_offset().is_some() {\ndiff --git a/komorebi/src/monitor.rs b/komorebi/src/monitor.rs\n--- a/komorebi/src/monitor.rs\n+++ b/komorebi/src/monitor.rs\n@@ -206,7 +205,7 @@ impl Monitor {\n \n         self.focused_workspace_mut()\n             .ok_or_else(|| anyhow!(\"there is no workspace\"))?\n-            .update(&work_area, offset, invisible_borders)?;\n+            .update(&work_area, offset)?;\n \n         Ok(())\n     }\ndiff --git a/komorebi/src/process_command.rs b/komorebi/src/process_command.rs\n--- a/komorebi/src/process_command.rs\n+++ b/komorebi/src/process_command.rs\n@@ -304,7 +304,6 @@ impl WindowManager {\n                     });\n                 }\n \n-                let invisible_borders = self.invisible_borders;\n                 let offset = self.work_area_offset;\n \n                 let mut hwnds_to_purge = vec![];\ndiff --git a/komorebi/src/process_command.rs b/komorebi/src/process_command.rs\n--- a/komorebi/src/process_command.rs\n+++ b/komorebi/src/process_command.rs\n@@ -347,7 +346,7 @@ impl WindowManager {\n                         .ok_or_else(|| anyhow!(\"there is no focused workspace\"))?\n                         .remove_window(hwnd)?;\n \n-                    monitor.update_focused_workspace(offset, &invisible_borders)?;\n+                    monitor.update_focused_workspace(offset)?;\n                 }\n             }\n             SocketMessage::FocusedWorkspaceContainerPadding(adjustment) => {\ndiff --git a/komorebi/src/process_command.rs b/komorebi/src/process_command.rs\n--- a/komorebi/src/process_command.rs\n+++ b/komorebi/src/process_command.rs\n@@ -1093,10 +1092,7 @@ impl WindowManager {\n             SocketMessage::UnmanageFocusedWindow => {\n                 self.unmanage_focused_window()?;\n             }\n-            SocketMessage::InvisibleBorders(rect) => {\n-                self.invisible_borders = rect;\n-                self.retile_all(false)?;\n-            }\n+            SocketMessage::InvisibleBorders(_rect) => {}\n             SocketMessage::WorkAreaOffset(rect) => {\n                 self.work_area_offset = Option::from(rect);\n                 self.retile_all(false)?;\ndiff --git a/komorebi/src/process_command.rs b/komorebi/src/process_command.rs\n--- a/komorebi/src/process_command.rs\n+++ b/komorebi/src/process_command.rs\n@@ -1252,17 +1248,7 @@ impl WindowManager {\n                 WindowsApi::invalidate_border_rect()?;\n             }\n             SocketMessage::ActiveWindowBorderOffset(offset) => {\n-                let mut current_border_offset = BORDER_OFFSET.lock();\n-\n-                let new_border_offset = Rect {\n-                    left: offset,\n-                    top: offset,\n-                    right: offset * 2,\n-                    bottom: offset * 2,\n-                };\n-\n-                *current_border_offset = Option::from(new_border_offset);\n-\n+                BORDER_OFFSET.store(offset, Ordering::SeqCst);\n                 WindowsApi::invalidate_border_rect()?;\n             }\n             SocketMessage::AltFocusHack(enable) => {\ndiff --git a/komorebi/src/process_command.rs b/komorebi/src/process_command.rs\n--- a/komorebi/src/process_command.rs\n+++ b/komorebi/src/process_command.rs\n@@ -1389,9 +1375,6 @@ impl WindowManager {\n             | SocketMessage::FocusWorkspaceNumber(_) => {\n                 let foreground = WindowsApi::foreground_window()?;\n                 let foreground_window = Window { hwnd: foreground };\n-                let mut rect = WindowsApi::window_rect(foreground_window.hwnd())?;\n-                rect.top -= self.invisible_borders.bottom;\n-                rect.bottom += self.invisible_borders.bottom;\n \n                 let monocle = BORDER_COLOUR_MONOCLE.load(Ordering::SeqCst);\n                 if monocle != 0 && self.focused_workspace()?.monocle_container().is_some() {\ndiff --git a/komorebi/src/process_command.rs b/komorebi/src/process_command.rs\n--- a/komorebi/src/process_command.rs\n+++ b/komorebi/src/process_command.rs\n@@ -1408,7 +1391,7 @@ impl WindowManager {\n                 }\n \n                 let border = Border::from(BORDER_HWND.load(Ordering::SeqCst));\n-                border.set_position(foreground_window, &self.invisible_borders, false)?;\n+                border.set_position(foreground_window, false)?;\n             }\n             SocketMessage::TogglePause => {\n                 let is_paused = self.is_paused;\ndiff --git a/komorebi/src/process_command.rs b/komorebi/src/process_command.rs\n--- a/komorebi/src/process_command.rs\n+++ b/komorebi/src/process_command.rs\n@@ -1418,7 +1401,7 @@ impl WindowManager {\n                     border.hide()?;\n                 } else {\n                     let focused = self.focused_window()?;\n-                    border.set_position(*focused, &self.invisible_borders, true)?;\n+                    border.set_position(*focused, true)?;\n                     focused.focus(false)?;\n                 }\n             }\ndiff --git a/komorebi/src/process_command.rs b/komorebi/src/process_command.rs\n--- a/komorebi/src/process_command.rs\n+++ b/komorebi/src/process_command.rs\n@@ -1428,7 +1411,7 @@ impl WindowManager {\n \n                 if tiling_enabled {\n                     let focused = self.focused_window()?;\n-                    border.set_position(*focused, &self.invisible_borders, true)?;\n+                    border.set_position(*focused, true)?;\n                     focused.focus(false)?;\n                 } else {\n                     border.hide()?;\ndiff --git a/komorebi/src/process_event.rs b/komorebi/src/process_event.rs\n--- a/komorebi/src/process_event.rs\n+++ b/komorebi/src/process_event.rs\n@@ -109,7 +109,6 @@ impl WindowManager {\n             _ => {}\n         }\n \n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n \n         for (i, monitor) in self.monitors_mut().iter_mut().enumerate() {\ndiff --git a/komorebi/src/process_event.rs b/komorebi/src/process_event.rs\n--- a/komorebi/src/process_event.rs\n+++ b/komorebi/src/process_event.rs\n@@ -123,7 +122,7 @@ impl WindowManager {\n             for (j, workspace) in monitor.workspaces_mut().iter_mut().enumerate() {\n                 let reaped_orphans = workspace.reap_orphans()?;\n                 if reaped_orphans.0 > 0 || reaped_orphans.1 > 0 {\n-                    workspace.update(&work_area, offset, &invisible_borders)?;\n+                    workspace.update(&work_area, offset)?;\n                     tracing::info!(\n                         \"reaped {} orphan window(s) and {} orphaned container(s) on monitor: {}, workspace: {}\",\n                         reaped_orphans.0,\ndiff --git a/komorebi/src/process_event.rs b/komorebi/src/process_event.rs\n--- a/komorebi/src/process_event.rs\n+++ b/komorebi/src/process_event.rs\n@@ -331,7 +330,6 @@ impl WindowManager {\n                     .ok_or_else(|| anyhow!(\"cannot get monitor idx from current position\"))?;\n \n                 let new_window_behaviour = self.window_container_behaviour;\n-                let invisible_borders = self.invisible_borders;\n \n                 let workspace = self.focused_workspace_mut()?;\n                 if !workspace\ndiff --git a/komorebi/src/process_event.rs b/komorebi/src/process_event.rs\n--- a/komorebi/src/process_event.rs\n+++ b/komorebi/src/process_event.rs\n@@ -366,12 +364,6 @@ impl WindowManager {\n                         }\n                     }\n \n-                    // Adjust for the invisible borders\n-                    new_position.left += invisible_borders.left;\n-                    new_position.top += invisible_borders.top;\n-                    new_position.right -= invisible_borders.right;\n-                    new_position.bottom -= invisible_borders.bottom;\n-\n                     let resize = Rect {\n                         left: new_position.left - old_position.left,\n                         top: new_position.top - old_position.top,\ndiff --git a/komorebi/src/process_event.rs b/komorebi/src/process_event.rs\n--- a/komorebi/src/process_event.rs\n+++ b/komorebi/src/process_event.rs\n@@ -382,9 +374,7 @@ impl WindowManager {\n                     // If we have moved across the monitors, use that override, otherwise determine\n                     // if a move has taken place by ruling out a resize\n                     let is_move = moved_across_monitors\n-                        || resize.right == 0 && resize.bottom == 0\n-                        || resize.right.abs() == invisible_borders.right\n-                            && resize.bottom.abs() == invisible_borders.bottom;\n+                        || resize.right == 0 && resize.bottom == 0;\n \n                     if is_move {\n                         tracing::info!(\"moving with mouse\");\ndiff --git a/komorebi/src/process_event.rs b/komorebi/src/process_event.rs\n--- a/komorebi/src/process_event.rs\n+++ b/komorebi/src/process_event.rs\n@@ -585,15 +575,10 @@ impl WindowManager {\n                     }\n \n                     if let Some(target_window) = target_window {\n-                        let window = target_window;\n-                        let mut rect = WindowsApi::window_rect(window.hwnd())?;\n-                        rect.top -= self.invisible_borders.bottom;\n-                        rect.bottom += self.invisible_borders.bottom;\n-\n                         let activate = BORDER_HIDDEN.load(Ordering::SeqCst);\n \n                         WindowsApi::invalidate_border_rect()?;\n-                        border.set_position(target_window, &self.invisible_borders, activate)?;\n+                        border.set_position(target_window, activate)?;\n \n                         if activate {\n                             BORDER_HIDDEN.store(false, Ordering::SeqCst);\ndiff --git a/komorebi/src/process_event.rs b/komorebi/src/process_event.rs\n--- a/komorebi/src/process_event.rs\n+++ b/komorebi/src/process_event.rs\n@@ -606,7 +591,7 @@ impl WindowManager {\n \n         // If we unmanaged a window, it shouldn't be immediately hidden behind managed windows\n         if let WindowManagerEvent::Unmanage(window) = event {\n-            window.center(&self.focused_monitor_work_area()?, &invisible_borders)?;\n+            window.center(&self.focused_monitor_work_area()?)?;\n         }\n \n         // If there are no more windows on the workspace, we shouldn't show the border window\ndiff --git a/komorebi/src/static_config.rs b/komorebi/src/static_config.rs\n--- a/komorebi/src/static_config.rs\n+++ b/komorebi/src/static_config.rs\n@@ -316,13 +316,6 @@ pub struct StaticConfig {\n impl From<&WindowManager> for StaticConfig {\n     #[allow(clippy::too_many_lines)]\n     fn from(value: &WindowManager) -> Self {\n-        let default_invisible_borders = Rect {\n-            left: 7,\n-            top: 0,\n-            right: 14,\n-            bottom: 7,\n-        };\n-\n         let mut monitors = vec![];\n         for m in value.monitors() {\n             monitors.push(MonitorConfig::from(m));\ndiff --git a/komorebi/src/static_config.rs b/komorebi/src/static_config.rs\n--- a/komorebi/src/static_config.rs\n+++ b/komorebi/src/static_config.rs\n@@ -392,11 +385,7 @@ impl From<&WindowManager> for StaticConfig {\n         };\n \n         Self {\n-            invisible_borders: if value.invisible_borders == default_invisible_borders {\n-                None\n-            } else {\n-                Option::from(value.invisible_borders)\n-            },\n+            invisible_borders: None,\n             resize_delta: Option::from(value.resize_delta),\n             window_container_behaviour: Option::from(value.window_container_behaviour),\n             cross_monitor_move_behaviour: Option::from(value.cross_monitor_move_behaviour),\ndiff --git a/komorebi/src/static_config.rs b/komorebi/src/static_config.rs\n--- a/komorebi/src/static_config.rs\n+++ b/komorebi/src/static_config.rs\n@@ -407,9 +396,7 @@ impl From<&WindowManager> for StaticConfig {\n             mouse_follows_focus: Option::from(value.mouse_follows_focus),\n             app_specific_configuration_path: None,\n             active_window_border_width: Option::from(BORDER_WIDTH.load(Ordering::SeqCst)),\n-            active_window_border_offset: BORDER_OFFSET\n-                .lock()\n-                .map_or(None, |offset| Option::from(offset.left)),\n+            active_window_border_offset: Option::from(BORDER_OFFSET.load(Ordering::SeqCst)),\n             active_window_border: Option::from(BORDER_ENABLED.load(Ordering::SeqCst)),\n             active_window_border_colours: border_colours,\n             default_workspace_padding: Option::from(\ndiff --git a/komorebi/src/static_config.rs b/komorebi/src/static_config.rs\n--- a/komorebi/src/static_config.rs\n+++ b/komorebi/src/static_config.rs\n@@ -462,29 +449,14 @@ impl StaticConfig {\n \n         self.active_window_border_width.map_or_else(\n             || {\n-                BORDER_WIDTH.store(20, Ordering::SeqCst);\n+                BORDER_WIDTH.store(8, Ordering::SeqCst);\n             },\n             |width| {\n                 BORDER_WIDTH.store(width, Ordering::SeqCst);\n             },\n         );\n-        self.active_window_border_offset.map_or_else(\n-            || {\n-                let mut border_offset = BORDER_OFFSET.lock();\n-                *border_offset = None;\n-            },\n-            |offset| {\n-                let new_border_offset = Rect {\n-                    left: offset,\n-                    top: offset,\n-                    right: offset * 2,\n-                    bottom: offset * 2,\n-                };\n \n-                let mut border_offset = BORDER_OFFSET.lock();\n-                *border_offset = Some(new_border_offset);\n-            },\n-        );\n+        BORDER_OFFSET.store(self.active_window_border_offset.unwrap_or(-1), Ordering::SeqCst);\n \n         if let Some(colours) = &self.active_window_border_colours {\n             BORDER_COLOUR_SINGLE.store(\ndiff --git a/komorebi/src/static_config.rs b/komorebi/src/static_config.rs\n--- a/komorebi/src/static_config.rs\n+++ b/komorebi/src/static_config.rs\n@@ -775,12 +747,6 @@ impl StaticConfig {\n             incoming_events: incoming,\n             command_listener: listener,\n             is_paused: false,\n-            invisible_borders: value.invisible_borders.unwrap_or(Rect {\n-                left: 7,\n-                top: 0,\n-                right: 14,\n-                bottom: 7,\n-            }),\n             virtual_desktop_id: current_virtual_desktop(),\n             work_area_offset: value.global_work_area_offset,\n             window_container_behaviour: value\ndiff --git a/komorebi/src/static_config.rs b/komorebi/src/static_config.rs\n--- a/komorebi/src/static_config.rs\n+++ b/komorebi/src/static_config.rs\n@@ -927,10 +893,6 @@ impl StaticConfig {\n             wm.hide_border()?;\n         }\n \n-        if let Some(val) = value.invisible_borders {\n-            wm.invisible_borders = val;\n-        }\n-\n         if let Some(val) = value.window_container_behaviour {\n             wm.window_container_behaviour = val;\n         }\ndiff --git a/komorebi/src/window.rs b/komorebi/src/window.rs\n--- a/komorebi/src/window.rs\n+++ b/komorebi/src/window.rs\n@@ -32,7 +32,6 @@ use crate::styles::WindowStyle;\n use crate::window_manager_event::WindowManagerEvent;\n use crate::windows_api::WindowsApi;\n use crate::ALT_FOCUS_HACK;\n-use crate::BORDER_OVERFLOW_IDENTIFIERS;\n use crate::FLOAT_IDENTIFIERS;\n use crate::HIDDEN_HWNDS;\n use crate::HIDING_BEHAVIOUR;\ndiff --git a/komorebi/src/window.rs b/komorebi/src/window.rs\n--- a/komorebi/src/window.rs\n+++ b/komorebi/src/window.rs\n@@ -129,7 +128,7 @@ impl Window {\n         HWND(self.hwnd)\n     }\n \n-    pub fn center(&mut self, work_area: &Rect, invisible_borders: &Rect) -> Result<()> {\n+    pub fn center(&mut self, work_area: &Rect) -> Result<()> {\n         let half_width = work_area.right / 2;\n         let half_weight = work_area.bottom / 2;\n \ndiff --git a/komorebi/src/window.rs b/komorebi/src/window.rs\n--- a/komorebi/src/window.rs\n+++ b/komorebi/src/window.rs\n@@ -140,7 +139,6 @@ impl Window {\n                 right: half_width,\n                 bottom: half_weight,\n             },\n-            invisible_borders,\n             true,\n         )\n     }\ndiff --git a/komorebi/src/window.rs b/komorebi/src/window.rs\n--- a/komorebi/src/window.rs\n+++ b/komorebi/src/window.rs\n@@ -148,34 +146,9 @@ impl Window {\n     pub fn set_position(\n         &mut self,\n         layout: &Rect,\n-        invisible_borders: &Rect,\n         top: bool,\n     ) -> Result<()> {\n-        let mut rect = *layout;\n-\n-        let border_overflows = BORDER_OVERFLOW_IDENTIFIERS.lock();\n-        let regex_identifiers = REGEX_IDENTIFIERS.lock();\n-\n-        let title = &self.title()?;\n-        let class = &self.class()?;\n-        let exe_name = &self.exe()?;\n-\n-        let should_remove_border = !should_act(\n-            title,\n-            exe_name,\n-            class,\n-            &border_overflows,\n-            &regex_identifiers,\n-        );\n-\n-        if should_remove_border {\n-            // Remove the invisible borders\n-            rect.left -= invisible_borders.left;\n-            rect.top -= invisible_borders.top;\n-            rect.right += invisible_borders.right;\n-            rect.bottom += invisible_borders.bottom;\n-        }\n-\n+        let rect = *layout;\n         WindowsApi::position_window(self.hwnd(), &rect, top)\n     }\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -69,7 +69,6 @@ pub struct WindowManager {\n     pub incoming_events: Receiver<WindowManagerEvent>,\n     pub command_listener: UnixListener,\n     pub is_paused: bool,\n-    pub invisible_borders: Rect,\n     pub work_area_offset: Option<Rect>,\n     pub resize_delta: i32,\n     pub window_container_behaviour: WindowContainerBehaviour,\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -89,7 +88,6 @@ pub struct WindowManager {\n pub struct State {\n     pub monitors: Ring<Monitor>,\n     pub is_paused: bool,\n-    pub invisible_borders: Rect,\n     pub resize_delta: i32,\n     pub new_window_behaviour: WindowContainerBehaviour,\n     pub cross_monitor_move_behaviour: MoveBehaviour,\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -119,7 +117,6 @@ impl From<&WindowManager> for State {\n         Self {\n             monitors: wm.monitors.clone(),\n             is_paused: wm.is_paused,\n-            invisible_borders: wm.invisible_borders,\n             work_area_offset: wm.work_area_offset,\n             resize_delta: wm.resize_delta,\n             new_window_behaviour: wm.window_container_behaviour,\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -190,12 +187,6 @@ impl WindowManager {\n             incoming_events: incoming,\n             command_listener: listener,\n             is_paused: false,\n-            invisible_borders: Rect {\n-                left: 7,\n-                top: 0,\n-                right: 14,\n-                bottom: 7,\n-            },\n             virtual_desktop_id: current_virtual_desktop(),\n             work_area_offset: None,\n             window_container_behaviour: WindowContainerBehaviour::Create,\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -222,12 +213,9 @@ impl WindowManager {\n     pub fn show_border(&self) -> Result<()> {\n         let foreground = WindowsApi::foreground_window()?;\n         let foreground_window = Window { hwnd: foreground };\n-        let mut rect = WindowsApi::window_rect(foreground_window.hwnd())?;\n-        rect.top -= self.invisible_borders.bottom;\n-        rect.bottom += self.invisible_borders.bottom;\n \n         let border = Border::from(BORDER_HWND.load(Ordering::SeqCst));\n-        border.set_position(foreground_window, &self.invisible_borders, true)?;\n+        border.set_position(foreground_window, true)?;\n         WindowsApi::invalidate_border_rect()\n     }\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -403,7 +391,6 @@ impl WindowManager {\n             }\n         }\n \n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n \n         for monitor in self.monitors_mut() {\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -434,7 +421,7 @@ impl WindowManager {\n             }\n \n             if should_update {\n-                monitor.update_focused_workspace(offset, &invisible_borders)?;\n+                monitor.update_focused_workspace(offset)?;\n             }\n         }\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -636,7 +623,6 @@ impl WindowManager {\n \n     #[tracing::instrument(skip(self))]\n     pub fn retile_all(&mut self, preserve_resize_dimensions: bool) -> Result<()> {\n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n \n         for monitor in self.monitors_mut() {\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -658,7 +644,7 @@ impl WindowManager {\n                 }\n             }\n \n-            workspace.update(&work_area, offset, &invisible_borders)?;\n+            workspace.update(&work_area, offset)?;\n         }\n \n         Ok(())\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -830,12 +816,11 @@ impl WindowManager {\n     pub fn update_focused_workspace(&mut self, follow_focus: bool) -> Result<()> {\n         tracing::info!(\"updating\");\n \n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n \n         self.focused_monitor_mut()\n             .ok_or_else(|| anyhow!(\"there is no monitor\"))?\n-            .update_focused_workspace(offset, &invisible_borders)?;\n+            .update_focused_workspace(offset)?;\n \n         if follow_focus {\n             if let Some(window) = self.focused_workspace()?.maximized_window() {\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1023,13 +1008,12 @@ impl WindowManager {\n     }\n \n     pub fn update_focused_workspace_by_monitor_idx(&mut self, idx: usize) -> Result<()> {\n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n \n         self.monitors_mut()\n             .get_mut(idx)\n             .ok_or_else(|| anyhow!(\"there is no monitor\"))?\n-            .update_focused_workspace(offset, &invisible_borders)\n+            .update_focused_workspace(offset)\n     }\n \n     #[tracing::instrument(skip(self))]\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1119,7 +1103,6 @@ impl WindowManager {\n \n         tracing::info!(\"moving container\");\n \n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n         let mouse_follows_focus = self.mouse_follows_focus;\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1138,7 +1121,7 @@ impl WindowManager {\n             .remove_focused_container()\n             .ok_or_else(|| anyhow!(\"there is no container\"))?;\n \n-        monitor.update_focused_workspace(offset, &invisible_borders)?;\n+        monitor.update_focused_workspace(offset)?;\n \n         let target_monitor = self\n             .monitors_mut()\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1147,7 +1130,7 @@ impl WindowManager {\n \n         target_monitor.add_container(container, workspace_idx)?;\n         target_monitor.load_focused_workspace(mouse_follows_focus)?;\n-        target_monitor.update_focused_workspace(offset, &invisible_borders)?;\n+        target_monitor.update_focused_workspace(offset)?;\n \n         if follow {\n             self.focus_monitor(monitor_idx)?;\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1329,12 +1312,11 @@ impl WindowManager {\n                 // make sure to update the origin monitor workspace layout because it is no\n                 // longer focused so it won't get updated at the end of this fn\n                 let offset = self.work_area_offset;\n-                let invisible_borders = self.invisible_borders;\n \n                 self.monitors_mut()\n                     .get_mut(origin_monitor_idx)\n                     .ok_or_else(|| anyhow!(\"there is no monitor at this index\"))?\n-                    .update_focused_workspace(offset, &invisible_borders)?;\n+                    .update_focused_workspace(offset)?;\n \n                 let a = self\n                     .focused_monitor()\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1558,7 +1540,6 @@ impl WindowManager {\n         tracing::info!(\"floating window\");\n \n         let work_area = self.focused_monitor_work_area()?;\n-        let invisible_borders = self.invisible_borders;\n \n         let workspace = self.focused_workspace_mut()?;\n         workspace.new_floating_window()?;\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1568,7 +1549,7 @@ impl WindowManager {\n             .last_mut()\n             .ok_or_else(|| anyhow!(\"there is no floating window\"))?;\n \n-        window.center(&work_area, &invisible_borders)?;\n+        window.center(&work_area)?;\n         window.focus(self.mouse_follows_focus)?;\n \n         Ok(())\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1825,7 +1806,6 @@ impl WindowManager {\n     ) -> Result<()> {\n         tracing::info!(\"setting workspace layout\");\n \n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n         let focused_monitor_idx = self.focused_monitor_idx();\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1854,7 +1834,7 @@ impl WindowManager {\n \n         // If this is the focused workspace on a non-focused screen, let's update it\n         if focused_monitor_idx != monitor_idx && focused_workspace_idx == workspace_idx {\n-            workspace.update(&work_area, offset, &invisible_borders)?;\n+            workspace.update(&work_area, offset)?;\n             Ok(())\n         } else {\n             Ok(self.update_focused_workspace(false)?)\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1874,7 +1854,6 @@ impl WindowManager {\n     {\n         tracing::info!(\"setting workspace layout\");\n \n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n         let focused_monitor_idx = self.focused_monitor_idx();\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1905,7 +1884,7 @@ impl WindowManager {\n \n         // If this is the focused workspace on a non-focused screen, let's update it\n         if focused_monitor_idx != monitor_idx && focused_workspace_idx == workspace_idx {\n-            workspace.update(&work_area, offset, &invisible_borders)?;\n+            workspace.update(&work_area, offset)?;\n             Ok(())\n         } else {\n             Ok(self.update_focused_workspace(false)?)\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1920,7 +1899,6 @@ impl WindowManager {\n     ) -> Result<()> {\n         tracing::info!(\"setting workspace layout\");\n \n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n         let focused_monitor_idx = self.focused_monitor_idx();\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1947,7 +1925,7 @@ impl WindowManager {\n \n         // If this is the focused workspace on a non-focused screen, let's update it\n         if focused_monitor_idx != monitor_idx && focused_workspace_idx == workspace_idx {\n-            workspace.update(&work_area, offset, &invisible_borders)?;\n+            workspace.update(&work_area, offset)?;\n             Ok(())\n         } else {\n             Ok(self.update_focused_workspace(false)?)\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1963,7 +1941,6 @@ impl WindowManager {\n     ) -> Result<()> {\n         tracing::info!(\"setting workspace layout\");\n \n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n         let focused_monitor_idx = self.focused_monitor_idx();\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -1989,7 +1966,7 @@ impl WindowManager {\n \n         // If this is the focused workspace on a non-focused screen, let's update it\n         if focused_monitor_idx != monitor_idx && focused_workspace_idx == workspace_idx {\n-            workspace.update(&work_area, offset, &invisible_borders)?;\n+            workspace.update(&work_area, offset)?;\n             Ok(())\n         } else {\n             Ok(self.update_focused_workspace(false)?)\ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -2008,7 +1985,6 @@ impl WindowManager {\n     {\n         tracing::info!(\"setting workspace layout\");\n         let layout = CustomLayout::from_path(path)?;\n-        let invisible_borders = self.invisible_borders;\n         let offset = self.work_area_offset;\n         let focused_monitor_idx = self.focused_monitor_idx();\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -2035,7 +2011,7 @@ impl WindowManager {\n \n         // If this is the focused workspace on a non-focused screen, let's update it\n         if focused_monitor_idx != monitor_idx && focused_workspace_idx == workspace_idx {\n-            workspace.update(&work_area, offset, &invisible_borders)?;\n+            workspace.update(&work_area, offset)?;\n             Ok(())\n         } else {\n             Ok(self.update_focused_workspace(false)?)\ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -22,6 +22,7 @@ use windows::Win32::Foundation::WPARAM;\n use windows::Win32::Graphics::Dwm::DwmGetWindowAttribute;\n use windows::Win32::Graphics::Dwm::DwmSetWindowAttribute;\n use windows::Win32::Graphics::Dwm::DWMWA_CLOAKED;\n+use windows::Win32::Graphics::Dwm::DWMWA_EXTENDED_FRAME_BOUNDS;\n use windows::Win32::Graphics::Dwm::DWMWA_WINDOW_CORNER_PREFERENCE;\n use windows::Win32::Graphics::Dwm::DWMWCP_ROUND;\n use windows::Win32::Graphics::Dwm::DWMWINDOWATTRIBUTE;\ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -53,6 +54,8 @@ use windows::Win32::System::Threading::PROCESS_ACCESS_RIGHTS;\n use windows::Win32::System::Threading::PROCESS_NAME_WIN32;\n use windows::Win32::System::Threading::PROCESS_QUERY_INFORMATION;\n use windows::Win32::UI::HiDpi::GetDpiForMonitor;\n+use windows::Win32::UI::HiDpi::GetDpiForSystem;\n+use windows::Win32::UI::HiDpi::GetDpiForWindow;\n use windows::Win32::UI::HiDpi::SetProcessDpiAwarenessContext;\n use windows::Win32::UI::HiDpi::DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2;\n use windows::Win32::UI::HiDpi::MDT_EFFECTIVE_DPI;\ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -101,7 +104,7 @@ use windows::Win32::UI::WindowsAndMessaging::GWL_STYLE;\n use windows::Win32::UI::WindowsAndMessaging::GW_HWNDNEXT;\n use windows::Win32::UI::WindowsAndMessaging::HWND_BOTTOM;\n use windows::Win32::UI::WindowsAndMessaging::HWND_NOTOPMOST;\n-use windows::Win32::UI::WindowsAndMessaging::HWND_TOPMOST;\n+use windows::Win32::UI::WindowsAndMessaging::HWND_TOP;\n use windows::Win32::UI::WindowsAndMessaging::LWA_ALPHA;\n use windows::Win32::UI::WindowsAndMessaging::LWA_COLORKEY;\n use windows::Win32::UI::WindowsAndMessaging::SET_WINDOW_POS_FLAGS;\ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -126,8 +129,7 @@ use windows::Win32::UI::WindowsAndMessaging::WS_DISABLED;\n use windows::Win32::UI::WindowsAndMessaging::WS_EX_LAYERED;\n use windows::Win32::UI::WindowsAndMessaging::WS_EX_NOACTIVATE;\n use windows::Win32::UI::WindowsAndMessaging::WS_EX_TOOLWINDOW;\n-use windows::Win32::UI::WindowsAndMessaging::WS_MAXIMIZEBOX;\n-use windows::Win32::UI::WindowsAndMessaging::WS_MINIMIZEBOX;\n+use windows::Win32::UI::WindowsAndMessaging::WS_EX_TOPMOST;\n use windows::Win32::UI::WindowsAndMessaging::WS_POPUP;\n use windows::Win32::UI::WindowsAndMessaging::WS_SYSMENU;\n \ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -340,14 +342,25 @@ impl WindowsApi {\n         unsafe { MonitorFromPoint(point, MONITOR_DEFAULTTONEAREST) }.0\n     }\n \n+    /// position window resizes the target window to the given layout, adjusting\n+    /// the layout to account for any window shadow borders (the window painted\n+    /// region will match layout on completion).\n     pub fn position_window(hwnd: HWND, layout: &Rect, top: bool) -> Result<()> {\n         let flags = SetWindowPosition::NO_ACTIVATE\n             | SetWindowPosition::NO_SEND_CHANGING\n             | SetWindowPosition::NO_COPY_BITS\n             | SetWindowPosition::FRAME_CHANGED;\n \n-        let position = if top { HWND_TOPMOST } else { HWND_BOTTOM };\n-        Self::set_window_pos(hwnd, layout, position, flags.bits())\n+        let shadow_rect = Self::shadow_rect(hwnd)?;\n+        let rect = Rect{\n+            left: layout.left + shadow_rect.left,\n+            top: layout.top + shadow_rect.top,\n+            right: layout.right + shadow_rect.right,\n+            bottom: layout.bottom + shadow_rect.bottom,\n+        };\n+\n+        let position = if top { HWND_TOP } else { HWND_BOTTOM };\n+        Self::set_window_pos(hwnd, &rect, position, flags.bits())\n     }\n \n     pub fn bring_window_to_top(hwnd: HWND) -> Result<()> {\ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -357,7 +370,7 @@ impl WindowsApi {\n     pub fn raise_window(hwnd: HWND) -> Result<()> {\n         let flags = SetWindowPosition::NO_MOVE;\n \n-        let position = HWND_TOPMOST;\n+        let position = HWND_TOP;\n         Self::set_window_pos(hwnd, &Rect::default(), position, flags.bits())\n     }\n \ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -368,6 +381,18 @@ impl WindowsApi {\n             SetWindowPosition::NO_ACTIVATE\n         };\n \n+        // TODO(raggi): This leaves the window behind the active window, which\n+        // can result e.g. single pixel window borders being invisible in the\n+        // case of opaque window borders (e.g. EPIC Games Launcher). Ideally\n+        // we'd be able to pass a parent window to place ourselves just in front\n+        // of, however the SetWindowPos API explicitly ignores that parameter\n+        // unless the window being positioned is being activated - and we don't\n+        // want to activate the border window here. We can hopefully find a\n+        // better workaround in the future.\n+        // The trade-off chosen prevents the border window from sitting over the\n+        // top of other pop-up dialogs such as a file picker dialog from\n+        // Firefox. When adjusting this in the future, it's important to check\n+        // those dialog cases.\n         let position = HWND_NOTOPMOST;\n         Self::set_window_pos(hwnd, layout, position, flags.bits())\n     }\ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -379,7 +404,8 @@ impl WindowsApi {\n         Self::set_window_pos(hwnd, &Rect::default(), position, flags.bits())\n     }\n \n-    pub fn set_window_pos(hwnd: HWND, layout: &Rect, position: HWND, flags: u32) -> Result<()> {\n+    /// set_window_pos calls SetWindowPos without any accounting for Window decorations.\n+    fn set_window_pos(hwnd: HWND, layout: &Rect, position: HWND, flags: u32) -> Result<()> {\n         unsafe {\n             SetWindowPos(\n                 hwnd,\ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -471,9 +497,34 @@ impl WindowsApi {\n \n     pub fn window_rect(hwnd: HWND) -> Result<Rect> {\n         let mut rect = unsafe { std::mem::zeroed() };\n-        unsafe { GetWindowRect(hwnd, &mut rect) }.process()?;\n \n-        Ok(Rect::from(rect))\n+        if Self::dwm_get_window_attribute(hwnd, DWMWA_EXTENDED_FRAME_BOUNDS, &mut rect).is_ok() {\n+            let window_scale = unsafe { GetDpiForWindow(hwnd) };\n+            let system_scale = unsafe { GetDpiForSystem() };\n+            Ok(Rect::from(rect).scale(system_scale.try_into()?, window_scale.try_into()?))\n+        } else {\n+            unsafe { GetWindowRect(hwnd, &mut rect) }.process()?;\n+            Ok(Rect::from(rect))\n+        }\n+    }\n+\n+    /// shadow_rect computes the offset of the shadow position of the window to\n+    /// the window painted region. The four values in the returned Rect can be\n+    /// added to a position rect to compute a size for set_window_pos that will\n+    /// fill the target area, ignoring shadows.\n+    fn shadow_rect(hwnd: HWND) -> Result<Rect> {\n+        let window_rect = Self::window_rect(hwnd)?;\n+\n+        let mut srect = Default::default();\n+        unsafe { GetWindowRect(hwnd, &mut srect) }.process()?;\n+        let shadow_rect = Rect::from(srect);\n+\n+        Ok(Rect {\n+            left: shadow_rect.left - window_rect.left,\n+            top: shadow_rect.top - window_rect.top,\n+            right: shadow_rect.right - window_rect.right,\n+            bottom: shadow_rect.bottom - window_rect.bottom,\n+        })\n     }\n \n     fn set_cursor_pos(x: i32, y: i32) -> Result<()> {\ndiff --git a/komorebi/src/windows_api.rs b/komorebi/src/windows_api.rs\n--- a/komorebi/src/windows_api.rs\n+++ b/komorebi/src/windows_api.rs\n@@ -849,10 +900,10 @@ impl WindowsApi {\n     pub fn create_border_window(name: PCWSTR, instance: HMODULE) -> Result<isize> {\n         unsafe {\n             let hwnd = CreateWindowExW(\n-                WS_EX_TOOLWINDOW | WS_EX_LAYERED,\n+                WS_EX_TOOLWINDOW | WS_EX_LAYERED | WS_EX_TOPMOST | WS_EX_NOACTIVATE,\n                 name,\n                 name,\n-                WS_POPUP | WS_SYSMENU | WS_MAXIMIZEBOX | WS_MINIMIZEBOX,\n+                WS_POPUP | WS_SYSMENU,\n                 CW_USEDEFAULT,\n                 CW_USEDEFAULT,\n                 CW_USEDEFAULT,\ndiff --git a/komorebi/src/windows_callbacks.rs b/komorebi/src/windows_callbacks.rs\n--- a/komorebi/src/windows_callbacks.rs\n+++ b/komorebi/src/windows_callbacks.rs\n@@ -13,11 +13,13 @@ use windows::Win32::Graphics::Gdi::BeginPaint;\n use windows::Win32::Graphics::Gdi::CreatePen;\n use windows::Win32::Graphics::Gdi::EndPaint;\n use windows::Win32::Graphics::Gdi::Rectangle;\n+use windows::Win32::Graphics::Gdi::RoundRect;\n use windows::Win32::Graphics::Gdi::SelectObject;\n use windows::Win32::Graphics::Gdi::ValidateRect;\n use windows::Win32::Graphics::Gdi::HDC;\n use windows::Win32::Graphics::Gdi::HMONITOR;\n use windows::Win32::Graphics::Gdi::PAINTSTRUCT;\n+use windows::Win32::Graphics::Gdi::PS_INSIDEFRAME;\n use windows::Win32::Graphics::Gdi::PS_SOLID;\n use windows::Win32::UI::Accessibility::HWINEVENTHOOK;\n use windows::Win32::UI::WindowsAndMessaging::DefWindowProcW;\ndiff --git a/komorebi/src/windows_callbacks.rs b/komorebi/src/windows_callbacks.rs\n--- a/komorebi/src/windows_callbacks.rs\n+++ b/komorebi/src/windows_callbacks.rs\n@@ -44,6 +46,7 @@ use crate::BORDER_WIDTH;\n use crate::DISPLAY_INDEX_PREFERENCES;\n use crate::MONITOR_INDEX_PREFERENCES;\n use crate::TRANSPARENCY_COLOUR;\n+use crate::WINDOWS_11;\n \n pub extern \"system\" fn valid_display_monitors(\n     hmonitor: HMONITOR,\ndiff --git a/komorebi/src/windows_callbacks.rs b/komorebi/src/windows_callbacks.rs\n--- a/komorebi/src/windows_callbacks.rs\n+++ b/komorebi/src/windows_callbacks.rs\n@@ -211,7 +214,7 @@ pub extern \"system\" fn border_window(\n                 let mut ps = PAINTSTRUCT::default();\n                 let hdc = BeginPaint(window, &mut ps);\n                 let hpen = CreatePen(\n-                    PS_SOLID,\n+                    PS_SOLID | PS_INSIDEFRAME,\n                     BORDER_WIDTH.load(Ordering::SeqCst),\n                     COLORREF(BORDER_COLOUR_CURRENT.load(Ordering::SeqCst)),\n                 );\ndiff --git a/komorebi/src/windows_callbacks.rs b/komorebi/src/windows_callbacks.rs\n--- a/komorebi/src/windows_callbacks.rs\n+++ b/komorebi/src/windows_callbacks.rs\n@@ -219,7 +222,17 @@ pub extern \"system\" fn border_window(\n \n                 SelectObject(hdc, hpen);\n                 SelectObject(hdc, hbrush);\n-                Rectangle(hdc, 0, 0, border_rect.right, border_rect.bottom);\n+                // TODO(raggi): this is approximately the correct curvature for\n+                // the top left of a Windows 11 window (DWMWCP_DEFAULT), but\n+                // often the bottom right has a different shape. Furthermore if\n+                // the window was made with DWMWCP_ROUNDSMALL then this is the\n+                // wrong size.  In the future we should read the DWM properties\n+                // of windows and attempt to match appropriately.\n+                if *WINDOWS_11 {\n+                    RoundRect(hdc, 0, 0, border_rect.right, border_rect.bottom, 20, 20);\n+                } else {\n+                    Rectangle(hdc, 0, 0, border_rect.right, border_rect.bottom);\n+                }\n                 EndPaint(window, &ps);\n                 ValidateRect(window, None);\n \ndiff --git a/komorebi/src/workspace.rs b/komorebi/src/workspace.rs\n--- a/komorebi/src/workspace.rs\n+++ b/komorebi/src/workspace.rs\n@@ -26,6 +26,8 @@ use crate::static_config::WorkspaceConfig;\n use crate::window::Window;\n use crate::window::WindowDetails;\n use crate::windows_api::WindowsApi;\n+use crate::BORDER_OFFSET;\n+use crate::BORDER_WIDTH;\n use crate::DEFAULT_CONTAINER_PADDING;\n use crate::DEFAULT_WORKSPACE_PADDING;\n use crate::INITIAL_CONFIGURATION_LOADED;\ndiff --git a/komorebi/src/workspace.rs b/komorebi/src/workspace.rs\n--- a/komorebi/src/workspace.rs\n+++ b/komorebi/src/workspace.rs\n@@ -205,7 +207,6 @@ impl Workspace {\n         &mut self,\n         work_area: &Rect,\n         offset: Option<Rect>,\n-        invisible_borders: &Rect,\n     ) -> Result<()> {\n         if !INITIAL_CONFIGURATION_LOADED.load(Ordering::SeqCst) {\n             return Ok(());\ndiff --git a/komorebi/src/workspace.rs b/komorebi/src/workspace.rs\n--- a/komorebi/src/workspace.rs\n+++ b/komorebi/src/workspace.rs\n@@ -225,7 +226,7 @@ impl Workspace {\n             },\n         );\n \n-        adjusted_work_area.add_padding(self.workspace_padding());\n+        adjusted_work_area.add_padding(self.workspace_padding().unwrap_or_default());\n \n         self.enforce_resize_constraints();\n \ndiff --git a/komorebi/src/workspace.rs b/komorebi/src/workspace.rs\n--- a/komorebi/src/workspace.rs\n+++ b/komorebi/src/workspace.rs\n@@ -252,8 +253,14 @@ impl Workspace {\n         if *self.tile() {\n             if let Some(container) = self.monocle_container_mut() {\n                 if let Some(window) = container.focused_window_mut() {\n-                    adjusted_work_area.add_padding(container_padding);\n-                    window.set_position(&adjusted_work_area, invisible_borders, true)?;\n+                    adjusted_work_area.add_padding(container_padding.unwrap_or_default());\n+                    {\n+                        let border_offset = BORDER_OFFSET.load(Ordering::SeqCst);\n+                        adjusted_work_area.add_padding(border_offset);\n+                        let width = BORDER_WIDTH.load(Ordering::SeqCst);\n+                        adjusted_work_area.add_padding(width);\n+                    }\n+                    window.set_position(&adjusted_work_area, true)?;\n                 };\n             } else if let Some(window) = self.maximized_window_mut() {\n                 window.maximize();\ndiff --git a/komorebi/src/workspace.rs b/komorebi/src/workspace.rs\n--- a/komorebi/src/workspace.rs\n+++ b/komorebi/src/workspace.rs\n@@ -288,7 +295,16 @@ impl Workspace {\n                             WindowsApi::restore_window(window.hwnd());\n                         }\n \n-                        window.set_position(layout, invisible_borders, false)?;\n+                        let mut rect = *layout;\n+                        {\n+                            let border_offset = BORDER_OFFSET.load(Ordering::SeqCst);\n+                            rect.add_padding(border_offset);\n+\n+                            let width = BORDER_WIDTH.load(Ordering::SeqCst);\n+                            rect.add_padding(width);\n+                        }\n+\n+                        window.set_position(&rect, false)?;\n                     }\n                 }\n \ndiff --git a/schema.json b/schema.json\n--- a/schema.json\n+++ b/schema.json\n@@ -107,12 +107,12 @@\n       }\n     },\n     \"active_window_border_offset\": {\n-      \"description\": \"Offset of the active window border (default: None)\",\n+      \"description\": \"Offset of the active window border (default: -1)\",\n       \"type\": \"integer\",\n       \"format\": \"int32\"\n     },\n     \"active_window_border_width\": {\n-      \"description\": \"Width of the active window border (default: 20)\",\n+      \"description\": \"Width of the active window border (default: 8)\",\n       \"type\": \"integer\",\n       \"format\": \"int32\"\n     },\n",
        "test_patch": "diff --git a/komorebi/src/process_event.rs b/komorebi/src/process_event.rs\n--- a/komorebi/src/process_event.rs\n+++ b/komorebi/src/process_event.rs\n@@ -341,7 +339,7 @@ impl WindowManager {\n                 {\n                     let focused_container_idx = workspace.focused_container_idx();\n \n-                    let mut new_position = WindowsApi::window_rect(window.hwnd())?;\n+                    let new_position = WindowsApi::window_rect(window.hwnd())?;\n \n                     let old_position = *workspace\n                         .latest_layout()\n",
        "problem_statement": "[BUG]: Window size imprecise\n**Describe the bug**\r\nSeveral applications have imprecise window size. So far I found WezTerm and Discord.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Install WezTerm and Discord\r\n2. Run komorebi with default setting (from Quickstart) with the following\r\n```\r\n  \"default_workspace_padding\": 5,\r\n  \"default_container_padding\": 5,\r\n```\r\n\r\n**Expected behavior**\r\nPrecise window size\r\n\r\n**Screenshots and Videos**\r\nWezTerm - Notepad++ (Notepad++ is fine)\r\n![image](https://github.com/LGUG2Z/komorebi/assets/57625126/9a70d76a-375f-4164-b806-aeffead4b646)\r\n\r\nChrome - Discord (really small/fine but it's there)\r\n![image](https://github.com/LGUG2Z/komorebi/assets/57625126/12d95626-5d47-403a-a2e2-48adf47989b3)\r\n![image](https://github.com/LGUG2Z/komorebi/assets/57625126/5390c60a-61df-4a2c-9a29-4fdf7a98a88c)\r\n\r\n**Operating System**\r\nProvide the output of `systeminfo | grep \"^OS Name\\|^OS Version\"`\r\n\r\n```\r\nOS Name:                   Microsoft Windows 10 IoT Enterprise LTSC\r\nOS Version:                10.0.19044 N/A Build 19044\r\n```\r\n\r\n**`komorebic check` Output**\r\nProvide the output of `komorebic check`\r\n\r\n```\r\nNo KOMOREBI_CONFIG_HOME detected, defaulting to C:\\Users\\mangkoran\r\n\r\nLooking for configuration files in C:\\Users\\mangkoran\r\n\r\nNo komorebi configuration found in C:\\Users\\mangkoran\r\n\r\nIf running 'komorebic start --await-configuration', you will manually have to call the following command to begin tiling: komorebic complete-configuration\r\n```\r\n\r\n**Additional context**\r\nNone\r\n\n",
        "hints_text": "I'm not sure that there is much that can be done here as these applications seem to be reporting their window and border dimensions incorrectly to the operating system. \n\nIn theory we could provide another per-window override configured by the user to target applications like this on a case by case basis, but it would be better for everyone if these issues could be fixed in the applications themselves rather than being targeted by overrides in a window manager.\n\nI'll leave this ticket open if people want to brainstorm, but I suggest opening issues on the repos of the relevant applications and referencing back to this issue.\nThank you for your reply.\r\n\r\nHmm if it's due to the affected application, then it is surely will be a long, hard work \ud83d\ude05\r\n\r\nI wonder, Microsoft's PowerToys has a feature called [FancyZones](https://learn.microsoft.com/en-us/windows/powertoys/fancyzones) that can \"tile\"/resize windows (although it's not a tiling WM like komorebi). I am using FZ daily, and with FZ it can tile almost (if not all) windows/apps perfectly. Well it is might be due to different implementation, but I wonder why FZ can tile more perfectly?\r\n\r\nWezTerm - Notepad++ (both using FZ)\r\n![image](https://github.com/LGUG2Z/komorebi/assets/57625126/b70d5e9c-ce63-42eb-877a-e4e092f092a8)\r\n\r\n\nI've tried to reproduce your first example on Windows 11, with significant overlapping of the windows of WezTerm and Notepad++ by using exaggerated negative container padding, but I haven't been able to reproduce the height difference shown on your first screenshot.\r\n\r\nThis is the only instance in the codebase where an override may be applied to window size calculation; it is explicitly opt-in and it applies overrides to all four sides of the `Rect` rather than any one side: https://github.com/LGUG2Z/komorebi/blob/master/komorebi/src/window.rs#L151\r\n\r\nOtherwise, all of the window size calculations are made indiscriminately on plain `Rect` objects with no information about the applications that they will be applied to; there isn't really a way that I can see that heights would be calculated different for specific applications regardless of their positions: https://github.com/LGUG2Z/komorebi/blob/master/komorebi-core/src/arrangement.rs#L28\r\n\r\nI'm not very familiar with the PowerToys/FancyZones codebase, but if someone is, and the replication of what they are doing to overcome these height differences does not require significant changes to the layout/arrangement code, I'm happy to accept a PR here.\r\n\r\nFor future users who notice this, can you please specify here if you are running Win10 or Win11? It would be good to get some more data to determine if this impacts both Win10+11, or just Win10. \ud83d\ude4f\nThis actually is a problem in GlazeWM and Komorebi if you try out FancyWM you will see that the issue doesn't exist for any applications even if applications are reporting wrong sizes. Lars thought this might be the correct way of doing things https://github.com/FancyWM/winman-windows/blob/67519f111af808aa29627ca715968b0ce86885b8/src/WinMan.Windows/Windows/Win32Window.cs#L606\nHmm @Zinvoke if we get the frame margins does that mean that we don't need to remove the invisible borders anymore? \ud83e\udd14\n> Hmm @Zinvoke if we get the frame margins does that mean that we don't need to remove the invisible borders anymore? \ud83e\udd14\r\n\r\nNo idea but somehow FancyWM pulls it off :(\r\nif you look at these screenshots you can see that the 2 outside windows when using komorebi are both different sizes then the middle window and when using FancyWM all of the windows are the same size!\r\n\r\nKomorebi Screenshot:\r\n![PrMlLLwNih](https://github.com/LGUG2Z/komorebi/assets/84819317/6289f07c-767d-4072-b2be-86221bfbfec4)\r\n  \r\nFancyWM Screenshot:\r\n![V0QmVr5OIB](https://github.com/LGUG2Z/komorebi/assets/84819317/61cd9e5b-3107-497e-b884-608e0bd9d997)\r\n\r\n**Note:** In the screenshots the border colors are changed via a program I made called FancyBorders using the  DWMWA_BORDER_COLOR flag which allows you to see the actual border sizes better and the programs are Explorer, Vscode, Windows Terminal, Discord",
        "created_at": "2024-02-20T06:37:58Z"
    },
    {
        "repo": "LGUG2Z/komorebi",
        "pull_number": 356,
        "instance_id": "LGUG2Z__komorebi-356",
        "issue_numbers": [
            "324"
        ],
        "base_commit": "b89e5eafd2bc5ccfb7267c7c9c92b0f97d223642",
        "patch": "diff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -26,6 +26,30 @@ Tiling Window Management for Windows.\n \n ![screenshot](https://user-images.githubusercontent.com/13164844/184027064-f5a6cec2-2865-4d65-a549-a1f1da589abf.png)\n \n+- [About](#about)\n+- [Charitable Donations](#charitable-donations)\n+- [GitHub Sponsors](#github-sponsors)\n+- [Demonstrations](#demonstrations)\n+- [Description](#description)\n+- [Design](#design)\n+- [Getting Started](#getting-started)\n+  - [Quickstart](#quickstart)\n+  - [GitHub Releases](#github-releases)\n+  - [Building from Source](#building-from-source)\n+  - [Running](#running)\n+  - [Configuring](#configuring)\n+  - [Common First-Time Tips](#common-first-time-tips)\n+- [Development](#development)\n+- [Logs and Debugging](#logs-and-debugging)\n+  - [Restoring Windows](#restoring-windows)\n+  - [Panics and Deadlocks](#panics-and-deadlocks)\n+- [Window Manager State and Integrations](#window-manager-state-and-integrations)\n+- [Window Manager Event Subscriptions](#window-manager-event-subscriptions)\n+  - [Subscription Event Notification Schema](#subscription-event-notification-schema)\n+  - [Communication over TCP](#communication-over-tcp)\n+  - [Socket Message Schema](#socket-message-schema)\n+- [Appreciations](#appreciations)\n+\n ## About\n \n _komorebi_ is a tiling window manager that works as an extension to\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -36,6 +60,10 @@ _komorebi_ allows you to control application windows, virtual workspaces and dis\n used with third-party software such as [AutoHotKey](https://github.com/Lexikos/AutoHotkey_L) to set user-defined\n keyboard shortcuts.\n \n+_komorebi_ aims to make _as few modifications as possible_ to the operating system and desktop environment by default.\n+Users are free to make such modifications in their own configuration files for _komorebi_, but these will remain\n+opt-in and off-by-default for the foreseeable future.\n+\n Translations of this document can be found in the project wiki:\n \n - [komorebi \u4e2d\u6587\u7528\u6237\u6307\u5357](https://github.com/LGUG2Z/komorebi/wiki/README-zh) (by [@crosstyan](https://github.com/crosstyan))\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -55,7 +83,16 @@ Articles, blog posts, demos, and videos about _komorebi_ can be added to this li\n - [Windows \u4e0b\u7684\u73b0\u4ee3\u5316\u5e73\u94fa\u7a97\u53e3\u7ba1\u7406\u5668 komorebi](https://zhuanlan.zhihu.com/p/455064481)\n - [komorebi \u3092\u5c0e\u5165\u3057\u3066\u307f\u308b](https://zenn.dev/omochice/articles/50f42a3df8f426)\n \n-## GitHub Sponsors Early Access\n+## Charitable Donations\n+\n+_komorebi_ is a free and open-source project, and one that encourages you to make charitable donations if\n+you find the software to be useful and have the financial means.\n+\n+I encourage you to make a charitable donation\n+to [Fresh Start Refugee](https://www.freshstartrefugee.org/donate) before\n+you consider sponsoring me on GitHub.\n+\n+## GitHub Sponsors\n \n [GitHub Sponsors is enabled for this project](https://github.com/sponsors/LGUG2Z). Users who sponsor my work\n on `komorebi` at any of the predefined monthly tiers will be given access to a private fork of this repository where I\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -67,15 +104,6 @@ available for free in the public repository once it meets the requisite level of\n Features-in-progress that are available in early access will be tagged in the issues with\n an [\"early access\" label](https://github.com/LGUG2Z/komorebi/issues?q=is%3Aopen+is%3Aissue+label%3A%22early+access%22).\n \n-## Charitable Donations\n-\n-`komorebi`, like `vim`, is a free and open-source project, and one that encourages you to make charitable donations if\n-you find the software to be useful and have the financial means.\n-\n-I encourage you to make a charitable donation\n-to [Fresh Start Refugee](https://www.freshstartrefugee.org/donate) before\n-you consider sponsoring me on GitHub.\n-\n ## Demonstrations\n \n [@haxibami](https://github.com/haxibami) showing _komorebi_ running on Windows\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -100,27 +128,19 @@ messages it receives on a dedicated socket.\n \n _komorebic_ is a CLI that writes messages on _komorebi_'s socket.\n \n-_komorebi_ doesn't handle any keyboard or mouse inputs; a third party program (e.g. AutoHotKey) is needed in order to\n-translate keyboard and mouse events to _komorebic_ commands.\n+_komorebi_ doesn't handle any keyboard or mouse inputs; a third party program (e.g.\n+[whkd](https://github.com/LGUG2Z/whkd)) is needed in order to translate keyboard and mouse events to _komorebic_ commands.\n \n This architecture, popularised by [_bspwm_](https://github.com/baskerville/bspwm) on Linux and\n [_yabai_](https://github.com/koekeishiya/yabai) on macOS, is outlined as follows:\n \n ```\n-     PROCESS                SOCKET\n-ahk  -------->  komorebic  <------>  komorebi\n+          PROCESS                SOCKET\n+whkd/ahk  -------->  komorebic  <------>  komorebi\n ```\n \n ## Design\n \n-_komorebi_ is the successor to [_yatta_](https://github.com/LGUG2Z/yatta) and as such aims to build on the learnings\n-from that project.\n-\n-While _yatta_ was primary an attempt to learn how to work with and call Windows APIs from Rust, while secondarily\n-implementing a minimal viable tiling window manager for my own needs (largely single monitor, single workspace),\n-_komorebi_ has been redesigned from the ground-up to support more complex features that have become standard in tiling\n-window managers on other platforms.\n-\n _komorebi_ holds a list of physical monitors.\n \n A monitor is just a rectangle of the available work area which contains one or more virtual workspaces.\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -185,28 +212,13 @@ cargo install --path komorebi --locked\n cargo install --path komorebic --locked\n ```\n \n-### Using Example Configurations\n-\n-To download example configurations from this repository, which will work regardless of your installation method, you may\n-run the following commands at a PowerShell prompt.\n-\n-These commands will download the `komorebi.sample.ahk`, `komorebic.lib.ahk` and `komorebi.generated.ahk` files from the\n-master branch of this repository and save them to your `$HOME` directory.\n-\n-```powershell\n-iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/komorebi.sample.ahk -OutFile $Env:USERPROFILE\\komorebi.ahk\n-iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/komorebic.lib.ahk -OutFile $Env:USERPROFILE\\komorebic.lib.ahk\n-iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/komorebi.generated.ahk -OutFile $Env:USERPROFILE\\komorebi.generated.ahk\n-```\n-\n ### Running\n \n-Once you have either the prebuilt binaries in your `Path`, or have compiled the binaries from source (these will already\n-be in your `Path` if you installed Rust with [rustup](https://rustup.rs), which you absolutely should), you can\n-run `komorebic start --await-configuration` at a Powershell prompt, and you will see the following output:\n+Run `komorebic start --await-configuration` at a Powershell prompt, and you will see the following output:\n \n ```\n-Start-Process komorebi -WindowStyle hidden\n+Start-Process komorebi.exe -ArgumentList '--await-configuration' -WindowStyle hidden\n+Waiting for komorebi.exe to start...Started!\n ```\n \n This means that `komorebi` is now running in the background, tiling all your windows, and listening for commands sent to\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -214,20 +226,43 @@ it by `komorebic`. You can similarly stop the process by running `komorebic stop\n \n ### Configuring\n \n-Once `komorebi` is running, you can execute the `komorebi.sample.ahk` script to set up the default keybindings via AHK\n-(the file includes comments to help you start building your own configuration).\n+If you followed the quickstart, `komorebi` will find the sample `komorebi.ps1` file in your `$Env:USERPROFILE` directory\n+and automatically load it. This file also starts `whkd` using the sample `whkrc` file in your `$Env:USERPROFILE\\.config`\n+directory.\n+\n+Alternatively, if you have AutoHotKey installed and a `komorebi.ahk` file in `$Env:UserProfile` directory, `komorebi`\n+will automatically try to load it when starting.\n+\n+#### Configuration with `komorebic`\n \n-If you have AutoHotKey installed and a `komorebi.ahk` file in your home directory (run `$Env:UserProfile` at a\n-PowerShell prompt to find your home directory), `komorebi` will automatically try to load it when starting.\n+As previously mentioned, this project does not handle anything related to keybindings and shortcuts directly. I\n+personally use [`whkd`](https://github.com/LGUG2Z/whkd) to manage my window management shortcuts, and have provided a\n+sample [whkdrc](whkdrc.sample) configuration that you can use as a starting point for your own.\n \n-There is also tentative support for loading a AutoHotKey v2 files, if the file is named `komorebi.ahk2` and\n-the `AutoHotKey64.exe` executable for AutoHotKey v2 is in your `Path`. If both `komorebi.ahk` and `komorebi.ahk2` files\n-exist in your home directory, only `komorebi.ahk` will be loaded. An example of an AutoHotKey v2 configuration file\n-for _komorebi_ can be found [here](https://gist.github.com/crosstyan/dafacc0778dabf693ce9236c57b201cd).\n+You can run `komorebic.exe` to get a full list of the commands that you can use to customise `komorebi` and create\n+keybindings with. You can run `komorebic.exe <COMMAND> --help` to get a full explanation of the arguments required for\n+each command.\n+\n+You can run any configuration command in the `komorebi.ps1` file, and you can bind any action command to your desired\n+key combinations in the `whkdrc` file.\n+\n+#### AutoHotKey Helper Library for `komorebic`\n+\n+\u2757\ufe0f**NOTE**: This section is only relevant for people who wish to use AutoHotKey instead of [`whkd`](https://github.com/LGUG2Z/whkd).\n+\n+\u2757\ufe0f**NOTE**: This helper library is only compatible with AutoHotKey v1.1, not with AutoHotKey v2.\n+\n+Additionally, you may run `komorebic.exe ahk-library` to generate a helper library for AutoHotKey which wraps\n+every `komorebic` command in a native AHK function.\n+\n+If you include the generated library at the top of your `~/komorebi.ahk` configuration file, you will be able to call\n+any of the functions that it contains.\n \n #### Using Different AHK Executables\n \n-The sample configuration and the generated helper library both currently only support AutoHotKey v1.1.\n+\u2757\ufe0f**NOTE**: This section is only relevant for people who wish to use AutoHotKey instead of [`whkd`](https://github.com/LGUG2Z/whkd).\n+\n+The generated helper library for AutoHotKey currently only supports AutoHotKey v1.1.\n \n The preferred way to install AutoHotKey for use with `komorebi` is to install it via `scoop`:\n \ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -239,17 +274,40 @@ scoop install autohotkey1.1\n If you install AutoHotKey using a different method, the name of the executable file may differ from the name given by\n `scoop`, and thus what is expected by default in `komorebi`.\n \n-You may override the executables that `komorebi` looks for to launch and reload `komorebi.ahk` configuration files using\n-by setting one of the following two environment variables depending on which version of AutoHotKey you wish to use:\n-\n-- `$Env:KOMOREBI_AHK_V1_EXE`\n-- `$Env:KOMOREBI_AHK_V2_EXE`\n+You may override the executable that `komorebi` looks for to launch and reload `komorebi.ahk` configuration files by\n+setting the `$Env:KOMOREBI_AHK_EXE` environment variable.\n \n Please keep in mind that even when setting a custom executable name using these environment variables, the executables\n are still required to be in your `Path`.\n \n ### Common First-Time Tips\n \n+#### Setting a Custom KOMOREBI_CONFIG_HOME Directory\n+\n+If you do not want to keep _komorebi_-related files in your `$Env:USERPROFILE` directory, you can specify a custom directory\n+by setting the `$Env:KOMOREBI_CONFIG_HOME` environment variable.\n+\n+For example, to use the `~/.config/komorebi` directory:\n+\n+```powershell\n+# Run this command to make sure that the directory has been created\n+mkdir -p ~/.config/komorebi\n+\n+# Run this command to open up your PowerShell profile configuration in Notepad\n+notepad $PROFILE\n+\n+# Add this line (with your login user!) to the bottom of your PowerShell profile configuration\n+$Env:KOMOREBI_CONFIG_HOME = 'C:\\Users\\LGUG2Z\\.config\\komorebi'\n+\n+# Save the changes and then reload the PowerShell profile\n+. $PROFILE\n+```\n+\n+If you already have configuration files that you wish to keep, move them to the `~/.config/komorebi` directory.\n+\n+The next time you run `komorebic start`, any files created by or loaded by _komorebi_ will be placed or expected to\n+exist in this folder.\n+\n #### Generating Common Application-Specific Configurations\n \n A curated selection of application-specific configurations can be generated to\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -257,7 +315,7 @@ help ease the setup for first-time users.\n [`komorebi-application-specific-configuration`](https://github.com/LGUG2Z/komorebi-application-specific-configuration)\n contains YAML definitions of settings that are known to make tricky\n applications behave as expected. These YAML definitions can be used to generate\n-an AHK file which you can import at the start of your own `komorebi.ahk` file,\n+a `ps1` or an `ahk` file which you can import at the start of your own `komorebi.ps1` or `komorebi.ahk` files,\n leaving you to focus primarily on your desired keybindings and workspace\n configurations.\n \ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -273,7 +331,12 @@ file.\n git clone https://github.com/LGUG2Z/komorebi-application-specific-configuration.git\n cd komorebi-application-specific-configuration\n \n-# Use komorebic to generate an AHK file\n+# Use komorebic to generate a ps1 file\n+komorebic.exe pwsh-app-specific-configuration applications.yaml\n+\n+# Application-specific generated configuration written to C:\\Users\\LGUG2Z\\.config\\komorebi\\komorebi.generated.ps1\n+\n+# Or use komorebic to generate an ahk file\n komorebic.exe ahk-app-specific-configuration applications.yaml\n \n # Application-specific generated configuration written to C:\\Users\\LGUG2Z\\.config\\komorebi\\komorebi.generated.ahk\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -283,35 +346,9 @@ komorebic.exe ahk-app-specific-configuration applications.yaml\n # #Include %A_ScriptDir%\\komorebi.generated.ahk\n \n # Optionally, provide an override file that follows the same schema as the second argument\n-komorebic.exe ahk-app-specific-configuration applications.yaml overrides.yaml\n+komorebic.exe pwsh-app-specific-configuration applications.yaml overrides.yaml\n ```\n \n-#### Setting a Custom KOMOREBI_CONFIG_HOME Directory\n-\n-If you do not want to keep _komorebi_-related files in your `$Env:UserProfile` directory, you can specify a custom directory\n-by setting the `$Env:KOMOREBI_CONFIG_HOME` environment variable.\n-\n-For example, to use the `~/.config/komorebi` directory:\n-\n-```powershell\n-# Run this command to make sure that the directory has been created\n-mkdir -p ~/.config/komorebi\n-\n-# Run this command to open up your PowerShell profile configuration in Notepad\n-notepad $PROFILE\n-\n-# Add this line (with your login user!) to the bottom of your PowerShell profile configuration\n-$Env:KOMOREBI_CONFIG_HOME = 'C:\\Users\\LGUG2Z\\.config\\komorebi'\n-\n-# Save the changes and then reload the PowerShell profile\n-. $PROFILE\n-```\n-\n-If you already have configuration files that you wish to keep, move them to the `~/.config/komorebi` directory.\n-\n-The next time you run `komorebic start`, any files created by or loaded by _komorebi_ will be placed or expected to\n-exist in this folder.\n-\n #### Adding an Active Window Border\n \n If you would like to add a visual border around the currently focused window, two commands are available:\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -337,6 +374,8 @@ komorebic.exe workspace-padding <MONITOR_INDEX> <WORKSPACE_INDEX> 0\n \n #### Multiple Layout Changes on Startup\n \n+\u2757\ufe0f**NOTE**: If you followed the quickstart and are using the sample configurations, this is already the default behaviour.\n+\n Depending on what is in your configuration, when `komorebi` is started, you may experience the layout rapidly being adjusted\n with many retile events.\n \ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -344,13 +383,16 @@ If you would like to avoid this, you can start `komorebi` with a flag which tell\n has been loaded before listening to and responding to window manager events: `komorebic start --await-configuration`.\n \n If you start `komorebi` with the `--await-configuration` flag, you _must_ send the `komorebic complete-configuration`\n-command at the end of the configuration section of your `komorebi.ahk` config (before you start defining the key\n-bindings). The layout will not be updated and `komorebi` will not respond to `komorebic` commands until this command has\n-been received.\n+command at the end of the configuration section of your `komorebi.ps1` (or `komorebi.ahk` config, before you start\n+defining the key bindings). The layout will not be updated and `komorebi` will not respond to `komorebic` commands until\n+this command has been received.\n \n #### Floating Windows\n \n-Sometimes you will want a specific application to never be tiled, and instead float all the time. You add add rules to\n+\u2757\ufe0f**NOTE**: A significant number of floating window rules for the most common applications are\n+[already generated for you](https://github.com/LGUG2Z/komorebi/#generating-common-application-specific-configurations)\n+\n+Sometimes you will want a specific application to never be tiled, and instead float all the time. You can add rules to\n enforce this behaviour:\n \n ```powershell\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -361,6 +403,9 @@ komorebic.exe float-rule title \"Control Panel\"\n \n #### Windows Not Getting Managed\n \n+\u2757\ufe0f**NOTE**: A significant number of force-manage window rules for the most common applications are\n+[already generated for you](https://github.com/LGUG2Z/komorebi/#generating-common-application-specific-configurations)\n+\n In some rare cases, a window may not automatically be registered to be managed by `komorebi`. When this happens, you can\n manually add a rule to force `komorebi` to manage it:\n \ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -372,6 +417,9 @@ komorebic.exe manage-rule exe TIM.exe\n \n #### Tray Applications\n \n+\u2757\ufe0f**NOTE**: A significant number of tray application rules for the most common applications are\n+[already generated for you](https://github.com/LGUG2Z/komorebi/#generating-common-application-specific-configurations)\n+\n If you are experiencing behaviour where\n [closing a window leaves a blank tile, but minimizing the same window does not](https://github.com/LGUG2Z/komorebi/issues/6)\n , you have probably enabled a 'close/minimize to tray' option for that application. You can tell _komorebi_ to handle\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -385,6 +433,9 @@ komorebic.exe identify-tray-application exe Discord.exe\n \n #### Microsoft Office Applications\n \n+\u2757\ufe0f**NOTE**: Microsoft Office-specific application rules are\n+[already generated for you](https://github.com/LGUG2Z/komorebi/#generating-common-application-specific-configurations)\n+\n Microsoft Office applications such as Word and Excel require certain configuration options to be set in order to be\n managed correctly. Below is an example of configuring Microsoft Word to be managed correctly by _komorebi_.\n \ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -527,83 +578,6 @@ layout rules for that workspace have been cleared.\n komorebic clear-workspace-layout-rules 0 0\n ```\n \n-## Configuration with `komorebic`\n-\n-As previously mentioned, this project does not handle anything related to keybindings and shortcuts directly. I\n-personally use AutoHotKey to manage my window management shortcuts, and have provided a\n-sample [komorebi.ahk](komorebi.sample.ahk) AHK script that you can use as a starting point for your own.\n-\n-You can run `komorebic.exe` to get a full list of the commands that you can use to customise `komorebi` and create\n-keybindings with. You can run `komorebic.exe <COMMAND> --help` to get a full explanation of the arguments required for\n-each command.\n-\n-### AutoHotKey Helper Library for `komorebic`\n-\n-Additionally, you may run `komorebic.exe ahk-library` to\n-generate [a helper library for AutoHotKey](komorebic.lib.sample.ahk) which wraps every `komorebic` command in a native\n-AHK function.\n-\n-If you include the generated library at the top of your `~/komorebi.ahk` configuration file, you will be able to call\n-any of the functions that it contains. A sample AHK script that shows how this library can be\n-used [is available here](komorebi.sample.with.lib.ahk).\n-\n-## Features\n-\n-- [x] Multi-monitor\n-- [x] Virtual workspaces\n-- [x] Window stacks\n-- [x] Cycle through stacked windows\n-- [x] Change focused window by direction\n-- [x] Change focused window by direction across monitor boundary\n-- [x] Move focused window container in direction\n-- [x] Move focused window container in direction across monitor boundary\n-- [x] Move focused window container to monitor and follow\n-- [x] Move focused window container to workspace follow\n-- [x] Send focused window container to monitor\n-- [x] Send focused window container to workspace\n-- [x] Move focused workspace to monitor\n-- [x] Mouse follows focused container\n-- [x] Resize window container in direction\n-- [x] Resize window container on axis\n-- [x] Set custom resize delta\n-- [x] Active window border\n-- [x] Quicksave and quickload layouts with resize dimensions\n-- [x] Save and load layouts with resize dimensions to/from specific files\n-- [x] Mouse drag to swap window container position\n-- [x] Mouse drag to resize window container\n-- [x] Configurable workspace and container gaps\n-- [x] BSP tree layout (`bsp`)\n-- [x] Flip BSP tree layout horizontally or vertically\n-- [x] Equal-width, max-height column layout (`columns`)\n-- [x] Equal-height, max-width row layout (`rows`)\n-- [x] Main half-height window with vertical stack layout (`horizontal-stack`)\n-- [x] Main half-width window with horizontal stack layout (`vertical-stack`)\n-- [x] 2x Main window (half and quarter-width) with horizontal stack layout (`ultrawide-vertical-stack`)\n-- [x] Load custom layouts from JSON and YAML representations\n-- [x] Dynamically select layout based on the number of open windows\n-- [x] Floating rules based on exe name, window title and class\n-- [x] Workspace rules based on exe name and window class\n-- [x] Additional manage rules based on exe name and window class\n-- [x] Identify applications which overflow their borders by exe name and class\n-- [x] Identify 'close/minimize to tray' applications by exe name and class\n-- [x] Configure work area offsets to preserve space for custom taskbars\n-- [x] Configure and compensate for the size of Windows invisible borders\n-- [x] Toggle floating windows\n-- [x] Toggle monocle window\n-- [x] Toggle native maximization\n-- [x] Toggle mouse follows focus\n-- [x] Toggle Xmouse/Windows focus follows mouse implementation\n-- [x] Toggle Komorebi focus follows mouse implementation (desktop and system tray-aware)\n-- [x] Toggle automatic tiling\n-- [x] Pause all window management\n-- [x] Load configuration on startup\n-- [x] Manually reload configuration\n-- [x] Watch configuration for changes\n-- [x] Helper library for AutoHotKey\n-- [x] View window manager state\n-- [x] Query window manager state\n-- [x] Subscribe to event and message notifications\n-\n ## Development\n \n If you would like to contribute code to this repository, there are a few requests that I have to ensure a foundation of\ndiff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -729,3 +703,15 @@ A [JSON Schema](https://json-schema.org/) of socket messages used to send instru\n with the `komorebic socket-schema` command. The output of this command can be redirected to the clipboard or a file,\n which can be used with services such as [Quicktype](https://app.quicktype.io/) to generate type definitions in different\n programming languages.\n+\n+## Appreciations\n+\n+- First and foremost, thank you to my wife, both for naming this project and for her patience throughout its never-ending development\n+\n+- Thank you to [@sitiom](https://github.com/sitiom) for being [an exemplary open source community leader](https://jeezy.substack.com/p/the-open-source-contributions-i-appreciate)\n+\n+- Thank you to the developers of [nog](https://github.com/TimUntersberger/nog) who came before me and whose work taught me more than I can ever hope to repay\n+\n+- Thank you to the developers of [GlazeWM](https://github.com/lars-berger/GlazeWM) for pushing the boundaries of tiling window management on Windows with me and having an excellent spirit of collaboration\n+\n+- Thank you to [@Ciantic](https://github.com/Ciantic) for helping me bring the [hidden Virtual Desktops cloaking function](https://github.com/Ciantic/AltTabAccessor/issues/1) to `komorebi`\ndiff --git a/justfile b/justfile\n--- a/justfile\n+++ b/justfile\n@@ -1,4 +1,4 @@\n-set shell := [\"cmd.exe\", \"/C\"]\n+set windows-shell := [\"pwsh.exe\", \"-NoLogo\", \"-Command\"]\n export RUST_BACKTRACE := \"full\"\n \n clean:\ndiff --git a/justfile b/justfile\n--- a/justfile\n+++ b/justfile\n@@ -22,9 +22,7 @@ install-komorebi:\n install:\n     just install-komorebic\n     just install-komorebi\n-    komorebic ahk-library\n-    cat '%USERPROFILE%\\.config\\komorebi\\komorebic.lib.ahk' > komorebic.lib.ahk\n-    cat '%USERPROFILE%\\.config\\komorebi\\komorebi.generated.ahk' > komorebi.generated.ahk\n+    cat '~/.config/komorebi/komorebi.generated.ps1' > komorebi.generated.ps1\n \n run:\n     just install-komorebic\ndiff --git a/komorebi-core/src/config_generation.rs b/komorebi-core/src/config_generation.rs\n--- a/komorebi-core/src/config_generation.rs\n+++ b/komorebi-core/src/config_generation.rs\n@@ -20,39 +20,44 @@ pub enum ApplicationOptions {\n }\n \n impl ApplicationOptions {\n+    #[must_use]\n+    pub fn raw_cfgen(&self, kind: &ApplicationIdentifier, id: &str) -> String {\n+        match self {\n+            ApplicationOptions::ObjectNameChange => {\n+                format!(\n+                    \"komorebic.exe identify-object-name-change-application {} \\\"{}\\\"\",\n+                    kind, id\n+                )\n+            }\n+            ApplicationOptions::Layered => {\n+                format!(\n+                    \"komorebic.exe identify-layered-application {} \\\"{}\\\"\",\n+                    kind, id\n+                )\n+            }\n+            ApplicationOptions::BorderOverflow => {\n+                format!(\n+                    \"komorebic.exe identify-border-overflow-application {} \\\"{}\\\"\",\n+                    kind, id\n+                )\n+            }\n+            ApplicationOptions::TrayAndMultiWindow => {\n+                format!(\n+                    \"komorebic.exe identify-tray-application {} \\\"{}\\\"\",\n+                    kind, id\n+                )\n+            }\n+            ApplicationOptions::Force => {\n+                format!(\"komorebic.exe manage-rule {} \\\"{}\\\"\", kind, id)\n+            }\n+        }\n+    }\n+\n     #[must_use]\n     pub fn cfgen(&self, kind: &ApplicationIdentifier, id: &str) -> String {\n         format!(\n             \"Run, {}, , Hide\",\n-            match self {\n-                ApplicationOptions::ObjectNameChange => {\n-                    format!(\n-                        \"komorebic.exe identify-object-name-change-application {} \\\"{}\\\"\",\n-                        kind, id\n-                    )\n-                }\n-                ApplicationOptions::Layered => {\n-                    format!(\n-                        \"komorebic.exe identify-layered-application {} \\\"{}\\\"\",\n-                        kind, id\n-                    )\n-                }\n-                ApplicationOptions::BorderOverflow => {\n-                    format!(\n-                        \"komorebic.exe identify-border-overflow-application {} \\\"{}\\\"\",\n-                        kind, id\n-                    )\n-                }\n-                ApplicationOptions::TrayAndMultiWindow => {\n-                    format!(\n-                        \"komorebic.exe identify-tray-application {} \\\"{}\\\"\",\n-                        kind, id\n-                    )\n-                }\n-                ApplicationOptions::Force => {\n-                    format!(\"komorebic.exe manage-rule {} \\\"{}\\\"\", kind, id)\n-                }\n-            }\n+            ApplicationOptions::raw_cfgen(self, kind, id)\n         )\n     }\n }\ndiff --git a/komorebi-core/src/config_generation.rs b/komorebi-core/src/config_generation.rs\n--- a/komorebi-core/src/config_generation.rs\n+++ b/komorebi-core/src/config_generation.rs\n@@ -118,6 +123,58 @@ impl ApplicationConfigurationGenerator {\n         Ok(final_cfgen)\n     }\n \n+    pub fn generate_pwsh(\n+        base_content: &str,\n+        override_content: Option<&str>,\n+    ) -> Result<Vec<String>> {\n+        let mut cfgen = if let Some(override_content) = override_content {\n+            Self::merge(base_content, override_content)?\n+        } else {\n+            Self::load(base_content)?\n+        };\n+\n+        cfgen.sort_by(|a, b| a.name.cmp(&b.name));\n+\n+        let mut lines = vec![String::from(\"# Generated by komorebic.exe\"), String::new()];\n+\n+        let mut float_rules = vec![];\n+\n+        for app in cfgen {\n+            lines.push(format!(\"# {}\", app.name));\n+            if let Some(options) = app.options {\n+                for opt in options {\n+                    if let ApplicationOptions::TrayAndMultiWindow = opt {\n+                        lines.push(String::from(\"# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\"));\n+                    }\n+\n+                    lines.push(opt.raw_cfgen(&app.identifier.kind, &app.identifier.id));\n+                }\n+            }\n+\n+            if let Some(float_identifiers) = app.float_identifiers {\n+                for float in float_identifiers {\n+                    let float_rule =\n+                        format!(\"komorebic.exe float-rule {} \\\"{}\\\"\", float.kind, float.id);\n+\n+                    // Don't want to send duped signals especially as configs get larger\n+                    if !float_rules.contains(&float_rule) {\n+                        float_rules.push(float_rule.clone());\n+\n+                        if let Some(comment) = float.comment {\n+                            lines.push(format!(\"# {}\", comment));\n+                        };\n+\n+                        lines.push(float_rule);\n+                    }\n+                }\n+            }\n+\n+            lines.push(String::new());\n+        }\n+\n+        Ok(lines)\n+    }\n+\n     pub fn generate_ahk(base_content: &str, override_content: Option<&str>) -> Result<Vec<String>> {\n         let mut cfgen = if let Some(override_content) = override_content {\n             Self::merge(base_content, override_content)?\ndiff --git a/komorebi.generated.ahk /dev/null\n--- a/komorebi.generated.ahk\n+++ /dev/null\n@@ -1,465 +0,0 @@\n-; Generated by komorebic.exe\n-; To use this file, add the line below to the top of your komorebi.ahk configuration file\n-; #Include %A_ScriptDir%\\komorebi.generated.ahk\n-\n-; 1Password\n-Run, komorebic.exe float-rule exe \"1Password.exe\", , Hide\n-\n-; Ableton Live\n-; Targets VST2 windows\n-Run, komorebic.exe float-rule class \"AbletonVstPlugClass\", , Hide\n-; Targets VST3 windows\n-Run, komorebic.exe float-rule class \"Vst3PlugWindow\", , Hide\n-\n-; Adobe Creative Cloud\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application class \"CreativeCloudDesktopWindowClass\", , Hide\n-\n-; Adobe Photoshop\n-Run, komorebic.exe identify-border-overflow-application class \"Photoshop\", , Hide\n-\n-; ArmCord\n-Run, komorebic.exe identify-border-overflow-application exe \"ArmCord.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ArmCord.exe\", , Hide\n-\n-; AutoHotkey\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"AutoHotkeyU64.exe\", , Hide\n-Run, komorebic.exe float-rule title \"Window Spy\", , Hide\n-\n-; Beeper\n-Run, komorebic.exe identify-border-overflow-application exe \"Beeper.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Beeper.exe\", , Hide\n-\n-; Bitwarden\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Bitwarden.exe\", , Hide\n-\n-; Bloxstrap\n-Run, komorebic.exe float-rule exe \"Bloxstrap.exe\", , Hide\n-\n-; Calculator\n-Run, komorebic.exe float-rule title \"Calculator\", , Hide\n-\n-; Credential Manager UI Host\n-; Targets the Windows popup prompting you for a PIN instead of a password on 1Password etc.\n-Run, komorebic.exe float-rule exe \"CredentialUIBroker.exe\", , Hide\n-\n-; Cron\n-Run, komorebic.exe identify-border-overflow-application exe \"Cron.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Cron.exe\", , Hide\n-\n-; Delphi applications\n-; Target hidden window spawned by Delphi applications\n-Run, komorebic.exe float-rule class \"TApplication\", , Hide\n-; Target Inno Setup installers\n-Run, komorebic.exe float-rule class \"TWizardForm\", , Hide\n-\n-; Discord\n-Run, komorebic.exe identify-border-overflow-application exe \"Discord.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Discord.exe\", , Hide\n-\n-; DiscordCanary\n-Run, komorebic.exe identify-border-overflow-application exe \"DiscordCanary.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"DiscordCanary.exe\", , Hide\n-\n-; DiscordDevelopment\n-Run, komorebic.exe identify-border-overflow-application exe \"DiscordDevelopment.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"DiscordDevelopment.exe\", , Hide\n-\n-; DiscordPTB\n-Run, komorebic.exe identify-border-overflow-application exe \"DiscordPTB.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"DiscordPTB.exe\", , Hide\n-\n-; ElectronMail\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ElectronMail.exe\", , Hide\n-\n-; Element\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Element.exe\", , Hide\n-\n-; ElevenClock\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ElevenClock.exe\", , Hide\n-\n-; Elgato Camera Hub\n-Run, komorebic.exe float-rule exe \"Camera Hub.exe\", , Hide\n-\n-; Elgato Control Center\n-Run, komorebic.exe float-rule exe \"ControlCenter.exe\", , Hide\n-\n-; Elgato Wave Link\n-Run, komorebic.exe float-rule exe \"WaveLink.exe\", , Hide\n-\n-; Epic Games Launcher\n-Run, komorebic.exe identify-border-overflow-application exe \"EpicGamesLauncher.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"EpicGamesLauncher.exe\", , Hide\n-\n-; Flow Launcher\n-Run, komorebic.exe identify-border-overflow-application exe \"Flow.Launcher.exe\", , Hide\n-\n-; GOG Galaxy\n-Run, komorebic.exe identify-border-overflow-application exe \"GalaxyClient.exe\", , Hide\n-Run, komorebic.exe manage-rule exe \"GalaxyClient.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"GalaxyClient.exe\", , Hide\n-; Targets a hidden window spawned by GOG Galaxy\n-Run, komorebic.exe float-rule class \"Chrome_RenderWidgetHostHWND\", , Hide\n-\n-; GoPro Webcam\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application class \"GoPro Webcam\", , Hide\n-\n-; Godot Manager\n-Run, komorebic.exe identify-border-overflow-application exe \"GodotManager.exe\", , Hide\n-Run, komorebic.exe manage-rule exe \"GodotManager.exe\", , Hide\n-Run, komorebic.exe identify-object-name-change-application exe \"GodotManager.exe\", , Hide\n-\n-; Google Chrome\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"chrome.exe\", , Hide\n-\n-; Google Drive\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"GoogleDriveFS.exe\", , Hide\n-\n-; Houdoku\n-Run, komorebic.exe identify-border-overflow-application exe \"Houdoku.exe\", , Hide\n-\n-; IntelliJ IDEA\n-Run, komorebic.exe identify-object-name-change-application exe \"idea64.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"idea64.exe\", , Hide\n-; Targets JetBrains IDE popups and floating windows\n-Run, komorebic.exe float-rule class \"SunAwtDialog\", , Hide\n-\n-; Itch.io\n-Run, komorebic.exe identify-border-overflow-application exe \"itch.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"itch.exe\", , Hide\n-\n-; Keyviz\n-Run, komorebic.exe float-rule exe \"keyviz.exe\", , Hide\n-\n-; Kleopatra\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"kleopatra.exe\", , Hide\n-\n-; Kotatogram\n-Run, komorebic.exe identify-border-overflow-application exe \"Kotatogram.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Kotatogram.exe\", , Hide\n-\n-; LocalSend\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"localsend_app.exe\", , Hide\n-\n-; Logi Bolt\n-Run, komorebic.exe float-rule exe \"LogiBolt.exe\", , Hide\n-\n-; LogiTune\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"LogiTune.exe\", , Hide\n-Run, komorebic.exe float-rule exe \"LogiTune.exe\", , Hide\n-\n-; Logitech G HUB\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"lghub.exe\", , Hide\n-Run, komorebic.exe identify-border-overflow-application exe \"lghub.exe\", , Hide\n-\n-; Logitech Options\n-Run, komorebic.exe float-rule exe \"LogiOptionsUI.exe\", , Hide\n-\n-; Mailspring\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"mailspring.exe\", , Hide\n-\n-; ManyCam\n-Run, komorebic.exe identify-border-overflow-application exe \"ManyCam.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ManyCam.exe\", , Hide\n-\n-; Mica For Everyone\n-\n-; Microsoft Excel\n-Run, komorebic.exe identify-border-overflow-application exe \"EXCEL.EXE\", , Hide\n-Run, komorebic.exe identify-layered-application exe \"EXCEL.EXE\", , Hide\n-; Targets a hidden window spawned by Microsoft Office applications\n-Run, komorebic.exe float-rule class \"_WwB\", , Hide\n-\n-; Microsoft Outlook\n-Run, komorebic.exe identify-border-overflow-application exe \"OUTLOOK.EXE\", , Hide\n-Run, komorebic.exe identify-layered-application exe \"OUTLOOK.EXE\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"OUTLOOK.EXE\", , Hide\n-\n-; Microsoft PC Manager\n-Run, komorebic.exe float-rule exe \"MSPCManager.exe\", , Hide\n-\n-; Microsoft PowerPoint\n-Run, komorebic.exe identify-border-overflow-application exe \"POWERPNT.EXE\", , Hide\n-Run, komorebic.exe identify-layered-application exe \"POWERPNT.EXE\", , Hide\n-\n-; Microsoft Teams\n-Run, komorebic.exe identify-border-overflow-application exe \"Teams.exe\", , Hide\n-; Target Teams pop-up notification windows\n-Run, komorebic.exe float-rule title \"Microsoft Teams Notification\", , Hide\n-; Target Teams call in progress windows\n-Run, komorebic.exe float-rule title \"Microsoft Teams Call\", , Hide\n-\n-; Microsoft Word\n-Run, komorebic.exe identify-border-overflow-application exe \"WINWORD.EXE\", , Hide\n-Run, komorebic.exe identify-layered-application exe \"WINWORD.EXE\", , Hide\n-\n-; Modern Flyouts\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ModernFlyoutsHost.exe\", , Hide\n-\n-; Mozilla Firefox\n-Run, komorebic.exe identify-object-name-change-application exe \"firefox.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"firefox.exe\", , Hide\n-; Targets invisible windows spawned by Firefox to show tab previews in the taskbar\n-Run, komorebic.exe float-rule class \"MozillaTaskbarPreviewClass\", , Hide\n-\n-; NVIDIA GeForce Experience\n-Run, komorebic.exe identify-border-overflow-application exe \"NVIDIA GeForce Experience.exe\", , Hide\n-\n-; NiceHash Miner\n-Run, komorebic.exe identify-border-overflow-application exe \"nhm_app.exe\", , Hide\n-Run, komorebic.exe manage-rule exe \"nhm_app.exe\", , Hide\n-\n-; NohBoard\n-Run, komorebic.exe float-rule exe \"NohBoard.exe\", , Hide\n-\n-; Notion Enhanced\n-Run, komorebic.exe identify-border-overflow-application exe \"Notion Enhanced.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Notion Enhanced.exe\", , Hide\n-\n-; OBS Studio (32-bit)\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"obs32.exe\", , Hide\n-\n-; OBS Studio (64-bit)\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"obs64.exe\", , Hide\n-\n-; ONLYOFFICE Editors\n-Run, komorebic.exe identify-border-overflow-application class \"DocEditorsWindowClass\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application class \"DocEditorsWindowClass\", , Hide\n-\n-; Obsidian\n-Run, komorebic.exe identify-border-overflow-application exe \"Obsidian.exe\", , Hide\n-Run, komorebic.exe manage-rule exe \"Obsidian.exe\", , Hide\n-\n-; OpenRGB\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"OpenRGB.exe\", , Hide\n-\n-; Paradox Launcher\n-Run, komorebic.exe float-rule exe \"Paradox Launcher.exe\", , Hide\n-\n-; PowerToys\n-; Target color picker dialog\n-Run, komorebic.exe float-rule exe \"PowerToys.ColorPickerUI.exe\", , Hide\n-; Target image resizer dialog\n-Run, komorebic.exe float-rule exe \"PowerToys.ImageResizer.exe\", , Hide\n-\n-; Process Hacker\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ProcessHacker.exe\", , Hide\n-Run, komorebic.exe float-rule exe \"ProcessHacker.exe\", , Hide\n-\n-; ProtonVPN\n-Run, komorebic.exe identify-border-overflow-application exe \"ProtonVPN.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ProtonVPN.exe\", , Hide\n-\n-; PyCharm\n-Run, komorebic.exe identify-object-name-change-application exe \"pycharm64.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"pycharm64.exe\", , Hide\n-\n-; QuickLook\n-Run, komorebic.exe float-rule exe \"QuickLook.exe\", , Hide\n-\n-; RepoZ\n-Run, komorebic.exe float-rule exe \"RepoZ.exe\", , Hide\n-\n-; Rider\n-Run, komorebic.exe identify-object-name-change-application exe \"rider64.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"rider64.exe\", , Hide\n-\n-; Roblox FPS Unlocker\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"rbxfpsunlocker.exe\", , Hide\n-\n-; RoundedTB\n-Run, komorebic.exe float-rule exe \"RoundedTB.exe\", , Hide\n-\n-; RoundedTB\n-Run, komorebic.exe identify-border-overflow-application exe \"RoundedTB.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"RoundedTB.exe\", , Hide\n-\n-; ShareX\n-Run, komorebic.exe identify-border-overflow-application exe \"ShareX.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ShareX.exe\", , Hide\n-\n-; Sideloadly\n-Run, komorebic.exe float-rule exe \"sideloadly.exe\", , Hide\n-\n-; Signal\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"signal.exe\", , Hide\n-\n-; SiriKali\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"sirikali.exe\", , Hide\n-\n-; Slack\n-Run, komorebic.exe identify-border-overflow-application exe \"Slack.exe\", , Hide\n-Run, komorebic.exe manage-rule exe \"Slack.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Slack.exe\", , Hide\n-\n-; Slack\n-Run, komorebic.exe identify-border-overflow-application exe \"slack.exe\", , Hide\n-Run, komorebic.exe manage-rule exe \"slack.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"slack.exe\", , Hide\n-\n-; Smart Install Maker\n-; Target hidden window spawned by installer\n-Run, komorebic.exe float-rule class \"obj_App\", , Hide\n-; Target installer\n-Run, komorebic.exe float-rule class \"obj_Form\", , Hide\n-\n-; SoulseekQt\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"SoulseekQt.exe\", , Hide\n-\n-; Spotify\n-Run, komorebic.exe identify-border-overflow-application exe \"Spotify.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Spotify.exe\", , Hide\n-\n-; Steam\n-Run, komorebic.exe identify-border-overflow-application class \"vguiPopupWindow\", , Hide\n-\n-; Stremio\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"stremio.exe\", , Hide\n-\n-; System Informer\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"SystemInformer.exe\", , Hide\n-Run, komorebic.exe float-rule exe \"SystemInformer.exe\", , Hide\n-\n-; SystemSettings\n-Run, komorebic.exe float-rule class \"Shell_Dialog\", , Hide\n-\n-; Task Manager\n-Run, komorebic.exe float-rule class \"TaskManagerWindow\", , Hide\n-\n-; Telegram\n-Run, komorebic.exe identify-border-overflow-application exe \"Telegram.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"Telegram.exe\", , Hide\n-\n-; TouchCursor\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"tcconfig.exe\", , Hide\n-Run, komorebic.exe float-rule exe \"tcconfig.exe\", , Hide\n-\n-; TranslucentTB\n-Run, komorebic.exe float-rule exe \"TranslucentTB.exe\", , Hide\n-\n-; TranslucentTB\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"TranslucentTB.exe\", , Hide\n-\n-; Unreal Editor\n-Run, komorebic.exe identify-border-overflow-application exe \"UnrealEditor.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"UnrealEditor.exe\", , Hide\n-\n-; VRCX\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"VRCX.exe\", , Hide\n-\n-; Visual Studio\n-Run, komorebic.exe identify-object-name-change-application exe \"devenv.exe\", , Hide\n-\n-; Visual Studio Code\n-Run, komorebic.exe identify-border-overflow-application exe \"Code.exe\", , Hide\n-\n-; Voice.ai\n-Run, komorebic.exe identify-border-overflow-application exe \"VoiceAI.exe\", , Hide\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"VoiceAI.exe\", , Hide\n-\n-; WebTorrent Desktop\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"WebTorrent.exe\", , Hide\n-\n-; Windows Console (conhost.exe)\n-Run, komorebic.exe manage-rule class \"ConsoleWindowClass\", , Hide\n-\n-; Windows Explorer\n-; Targets copy/move operation windows\n-Run, komorebic.exe float-rule class \"OperationStatusWindow\", , Hide\n-Run, komorebic.exe float-rule title \"Control Panel\", , Hide\n-\n-; Windows Installer\n-Run, komorebic.exe float-rule exe \"msiexec.exe\", , Hide\n-\n-; WingetUI\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"WingetUI.exe\", , Hide\n-\n-; WingetUI\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"wingetui.exe\", , Hide\n-\n-; Wox\n-; Targets a hidden window spawned by Wox\n-Run, komorebic.exe float-rule title \"Hotkey sink\", , Hide\n-\n-; XAMPP Control Panel\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"xampp-control.exe\", , Hide\n-\n-; Zoom\n-Run, komorebic.exe float-rule exe \"Zoom.exe\", , Hide\n-\n-; mpv.net\n-Run, komorebic.exe identify-object-name-change-application exe \"mpvnet.exe\", , Hide\n-\n-; paint.net\n-Run, komorebic.exe float-rule exe \"paintdotnet.exe\", , Hide\n-\n-; pinentry\n-Run, komorebic.exe float-rule exe \"pinentry.exe\", , Hide\n-\n-; qBittorrent\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"qbittorrent.exe\", , Hide\n-\n-; ueli\n-; If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n-Run, komorebic.exe identify-tray-application exe \"ueli.exe\", , Hide\n-Run, komorebic.exe float-rule exe \"ueli.exe\", , Hide\ndiff --git /dev/null b/komorebi.generated.ps1\nnew file mode 100644\n--- /dev/null\n+++ b/komorebi.generated.ps1\n@@ -0,0 +1,470 @@\n+# Generated by komorebic.exe\n+\n+# 1Password\n+komorebic.exe float-rule exe \"1Password.exe\"\n+\n+# Ableton Live\n+# Targets VST2 windows\n+komorebic.exe float-rule class \"AbletonVstPlugClass\"\n+# Targets VST3 windows\n+komorebic.exe float-rule class \"Vst3PlugWindow\"\n+\n+# Adobe Creative Cloud\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application class \"CreativeCloudDesktopWindowClass\"\n+\n+# Adobe Photoshop\n+komorebic.exe identify-border-overflow-application class \"Photoshop\"\n+\n+# ArmCord\n+komorebic.exe identify-border-overflow-application exe \"ArmCord.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ArmCord.exe\"\n+\n+# AutoHotkey\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"AutoHotkeyU64.exe\"\n+komorebic.exe float-rule title \"Window Spy\"\n+\n+# Beeper\n+komorebic.exe identify-border-overflow-application exe \"Beeper.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Beeper.exe\"\n+\n+# Bitwarden\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Bitwarden.exe\"\n+\n+# Bloxstrap\n+komorebic.exe float-rule exe \"Bloxstrap.exe\"\n+\n+# Calculator\n+komorebic.exe float-rule title \"Calculator\"\n+\n+# Credential Manager UI Host\n+# Targets the Windows popup prompting you for a PIN instead of a password on 1Password etc.\n+komorebic.exe float-rule exe \"CredentialUIBroker.exe\"\n+\n+# Cron\n+komorebic.exe identify-border-overflow-application exe \"Cron.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Cron.exe\"\n+\n+# Delphi applications\n+# Target hidden window spawned by Delphi applications\n+komorebic.exe float-rule class \"TApplication\"\n+# Target Inno Setup installers\n+komorebic.exe float-rule class \"TWizardForm\"\n+\n+# Discord\n+komorebic.exe identify-border-overflow-application exe \"Discord.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Discord.exe\"\n+\n+# DiscordCanary\n+komorebic.exe identify-border-overflow-application exe \"DiscordCanary.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"DiscordCanary.exe\"\n+\n+# DiscordDevelopment\n+komorebic.exe identify-border-overflow-application exe \"DiscordDevelopment.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"DiscordDevelopment.exe\"\n+\n+# DiscordPTB\n+komorebic.exe identify-border-overflow-application exe \"DiscordPTB.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"DiscordPTB.exe\"\n+\n+# ElectronMail\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ElectronMail.exe\"\n+\n+# Element\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Element.exe\"\n+\n+# ElevenClock\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ElevenClock.exe\"\n+\n+# Elgato Camera Hub\n+komorebic.exe float-rule exe \"Camera Hub.exe\"\n+\n+# Elgato Control Center\n+komorebic.exe float-rule exe \"ControlCenter.exe\"\n+\n+# Elgato Wave Link\n+komorebic.exe float-rule exe \"WaveLink.exe\"\n+\n+# Epic Games Launcher\n+komorebic.exe identify-border-overflow-application exe \"EpicGamesLauncher.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"EpicGamesLauncher.exe\"\n+\n+# Flow Launcher\n+komorebic.exe identify-border-overflow-application exe \"Flow.Launcher.exe\"\n+\n+# GOG Galaxy\n+komorebic.exe identify-border-overflow-application exe \"GalaxyClient.exe\"\n+komorebic.exe manage-rule exe \"GalaxyClient.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"GalaxyClient.exe\"\n+# Targets a hidden window spawned by GOG Galaxy\n+komorebic.exe float-rule class \"Chrome_RenderWidgetHostHWND\"\n+\n+# GoPro Webcam\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application class \"GoPro Webcam\"\n+\n+# Godot Manager\n+komorebic.exe identify-border-overflow-application exe \"GodotManager.exe\"\n+komorebic.exe manage-rule exe \"GodotManager.exe\"\n+komorebic.exe identify-object-name-change-application exe \"GodotManager.exe\"\n+\n+# Google Chrome\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"chrome.exe\"\n+\n+# Google Drive\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"GoogleDriveFS.exe\"\n+\n+# Houdoku\n+komorebic.exe identify-border-overflow-application exe \"Houdoku.exe\"\n+\n+# IntelliJ IDEA\n+komorebic.exe identify-object-name-change-application exe \"idea64.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"idea64.exe\"\n+# Targets JetBrains IDE popups and floating windows\n+komorebic.exe float-rule class \"SunAwtDialog\"\n+\n+# Itch.io\n+komorebic.exe identify-border-overflow-application exe \"itch.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"itch.exe\"\n+\n+# Keyviz\n+komorebic.exe float-rule exe \"keyviz.exe\"\n+\n+# Kleopatra\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"kleopatra.exe\"\n+\n+# Kotatogram\n+komorebic.exe identify-border-overflow-application exe \"Kotatogram.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Kotatogram.exe\"\n+\n+# LocalSend\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"localsend_app.exe\"\n+\n+# Logi Bolt\n+komorebic.exe float-rule exe \"LogiBolt.exe\"\n+\n+# LogiTune\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"LogiTune.exe\"\n+komorebic.exe float-rule exe \"LogiTune.exe\"\n+\n+# Logitech G HUB\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"lghub.exe\"\n+komorebic.exe identify-border-overflow-application exe \"lghub.exe\"\n+\n+# Logitech Options\n+komorebic.exe float-rule exe \"LogiOptionsUI.exe\"\n+\n+# Mailspring\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"mailspring.exe\"\n+\n+# ManyCam\n+komorebic.exe identify-border-overflow-application exe \"ManyCam.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ManyCam.exe\"\n+\n+# Mica For Everyone\n+\n+# Microsoft Excel\n+komorebic.exe identify-border-overflow-application exe \"EXCEL.EXE\"\n+komorebic.exe identify-layered-application exe \"EXCEL.EXE\"\n+# Targets a hidden window spawned by Microsoft Office applications\n+komorebic.exe float-rule class \"_WwB\"\n+\n+# Microsoft Outlook\n+komorebic.exe identify-border-overflow-application exe \"OUTLOOK.EXE\"\n+komorebic.exe identify-layered-application exe \"OUTLOOK.EXE\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"OUTLOOK.EXE\"\n+\n+# Microsoft PC Manager\n+komorebic.exe float-rule exe \"MSPCManager.exe\"\n+\n+# Microsoft PowerPoint\n+komorebic.exe identify-border-overflow-application exe \"POWERPNT.EXE\"\n+komorebic.exe identify-layered-application exe \"POWERPNT.EXE\"\n+\n+# Microsoft Teams\n+komorebic.exe identify-border-overflow-application exe \"Teams.exe\"\n+# Target Teams pop-up notification windows\n+komorebic.exe float-rule title \"Microsoft Teams Notification\"\n+# Target Teams call in progress windows\n+komorebic.exe float-rule title \"Microsoft Teams Call\"\n+\n+# Microsoft Word\n+komorebic.exe identify-border-overflow-application exe \"WINWORD.EXE\"\n+komorebic.exe identify-layered-application exe \"WINWORD.EXE\"\n+\n+# Modern Flyouts\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ModernFlyoutsHost.exe\"\n+\n+# Mozilla Firefox\n+komorebic.exe identify-object-name-change-application exe \"firefox.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"firefox.exe\"\n+# Targets invisible windows spawned by Firefox to show tab previews in the taskbar\n+komorebic.exe float-rule class \"MozillaTaskbarPreviewClass\"\n+\n+# NVIDIA GeForce Experience\n+komorebic.exe identify-border-overflow-application exe \"NVIDIA GeForce Experience.exe\"\n+\n+# NiceHash Miner\n+komorebic.exe identify-border-overflow-application exe \"nhm_app.exe\"\n+komorebic.exe manage-rule exe \"nhm_app.exe\"\n+\n+# NohBoard\n+komorebic.exe float-rule exe \"NohBoard.exe\"\n+\n+# Notion Enhanced\n+komorebic.exe identify-border-overflow-application exe \"Notion Enhanced.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Notion Enhanced.exe\"\n+\n+# OBS Studio (32-bit)\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"obs32.exe\"\n+\n+# OBS Studio (64-bit)\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"obs64.exe\"\n+\n+# ONLYOFFICE Editors\n+komorebic.exe identify-border-overflow-application class \"DocEditorsWindowClass\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application class \"DocEditorsWindowClass\"\n+\n+# Obsidian\n+komorebic.exe identify-border-overflow-application exe \"Obsidian.exe\"\n+komorebic.exe manage-rule exe \"Obsidian.exe\"\n+\n+# OpenRGB\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"OpenRGB.exe\"\n+\n+# Paradox Launcher\n+komorebic.exe float-rule exe \"Paradox Launcher.exe\"\n+\n+# Plexamp\n+komorebic.exe identify-border-overflow-application exe \"Plexamp.exe\"\n+\n+# PowerToys\n+# Target color picker dialog\n+komorebic.exe float-rule exe \"PowerToys.ColorPickerUI.exe\"\n+# Target image resizer dialog\n+komorebic.exe float-rule exe \"PowerToys.ImageResizer.exe\"\n+\n+# Process Hacker\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ProcessHacker.exe\"\n+komorebic.exe float-rule exe \"ProcessHacker.exe\"\n+\n+# ProtonVPN\n+komorebic.exe identify-border-overflow-application exe \"ProtonVPN.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ProtonVPN.exe\"\n+\n+# PyCharm\n+komorebic.exe identify-object-name-change-application exe \"pycharm64.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"pycharm64.exe\"\n+\n+# QtScrcpy\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"QtScrcpy.exe\"\n+\n+# QuickLook\n+komorebic.exe float-rule exe \"QuickLook.exe\"\n+\n+# RepoZ\n+komorebic.exe float-rule exe \"RepoZ.exe\"\n+\n+# Rider\n+komorebic.exe identify-object-name-change-application exe \"rider64.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"rider64.exe\"\n+\n+# Roblox FPS Unlocker\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"rbxfpsunlocker.exe\"\n+\n+# RoundedTB\n+komorebic.exe float-rule exe \"RoundedTB.exe\"\n+\n+# RoundedTB\n+komorebic.exe identify-border-overflow-application exe \"RoundedTB.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"RoundedTB.exe\"\n+\n+# ShareX\n+komorebic.exe identify-border-overflow-application exe \"ShareX.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ShareX.exe\"\n+\n+# Sideloadly\n+komorebic.exe float-rule exe \"sideloadly.exe\"\n+\n+# Signal\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"signal.exe\"\n+\n+# SiriKali\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"sirikali.exe\"\n+\n+# Slack\n+komorebic.exe identify-border-overflow-application exe \"Slack.exe\"\n+komorebic.exe manage-rule exe \"Slack.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Slack.exe\"\n+\n+# Slack\n+komorebic.exe identify-border-overflow-application exe \"slack.exe\"\n+komorebic.exe manage-rule exe \"slack.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"slack.exe\"\n+\n+# Smart Install Maker\n+# Target hidden window spawned by installer\n+komorebic.exe float-rule class \"obj_App\"\n+# Target installer\n+komorebic.exe float-rule class \"obj_Form\"\n+\n+# SoulseekQt\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"SoulseekQt.exe\"\n+\n+# Spotify\n+komorebic.exe identify-border-overflow-application exe \"Spotify.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Spotify.exe\"\n+\n+# Steam\n+komorebic.exe identify-border-overflow-application class \"vguiPopupWindow\"\n+\n+# Stremio\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"stremio.exe\"\n+\n+# System Informer\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"SystemInformer.exe\"\n+komorebic.exe float-rule exe \"SystemInformer.exe\"\n+\n+# SystemSettings\n+komorebic.exe float-rule class \"Shell_Dialog\"\n+\n+# Task Manager\n+komorebic.exe float-rule class \"TaskManagerWindow\"\n+\n+# Telegram\n+komorebic.exe identify-border-overflow-application exe \"Telegram.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"Telegram.exe\"\n+\n+# TouchCursor\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"tcconfig.exe\"\n+komorebic.exe float-rule exe \"tcconfig.exe\"\n+\n+# TranslucentTB\n+komorebic.exe float-rule exe \"TranslucentTB.exe\"\n+\n+# TranslucentTB\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"TranslucentTB.exe\"\n+\n+# Unreal Editor\n+komorebic.exe identify-border-overflow-application exe \"UnrealEditor.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"UnrealEditor.exe\"\n+\n+# VRCX\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"VRCX.exe\"\n+\n+# Visual Studio\n+komorebic.exe identify-object-name-change-application exe \"devenv.exe\"\n+\n+# Visual Studio Code\n+komorebic.exe identify-border-overflow-application exe \"Code.exe\"\n+\n+# Voice.ai\n+komorebic.exe identify-border-overflow-application exe \"VoiceAI.exe\"\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"VoiceAI.exe\"\n+\n+# WebTorrent Desktop\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"WebTorrent.exe\"\n+\n+# Windows Console (conhost.exe)\n+komorebic.exe manage-rule class \"ConsoleWindowClass\"\n+\n+# Windows Explorer\n+# Targets copy/move operation windows\n+komorebic.exe float-rule class \"OperationStatusWindow\"\n+komorebic.exe float-rule title \"Control Panel\"\n+\n+# Windows Installer\n+komorebic.exe float-rule exe \"msiexec.exe\"\n+\n+# WingetUI\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"WingetUI.exe\"\n+\n+# WingetUI\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"wingetui.exe\"\n+\n+# Wox\n+# Targets a hidden window spawned by Wox\n+komorebic.exe float-rule title \"Hotkey sink\"\n+\n+# XAMPP Control Panel\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"xampp-control.exe\"\n+\n+# Zoom\n+komorebic.exe float-rule exe \"Zoom.exe\"\n+\n+# mpv.net\n+komorebic.exe identify-object-name-change-application exe \"mpvnet.exe\"\n+\n+# paint.net\n+komorebic.exe float-rule exe \"paintdotnet.exe\"\n+\n+# pinentry\n+komorebic.exe float-rule exe \"pinentry.exe\"\n+\n+# qBittorrent\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"qbittorrent.exe\"\n+\n+# ueli\n+# If you have disabled minimize/close to tray for this application, you can delete/comment out the next line\n+komorebic.exe identify-tray-application exe \"ueli.exe\"\n+komorebic.exe float-rule exe \"ueli.exe\"\ndiff --git a/komorebi.sample.ahk /dev/null\n--- a/komorebi.sample.ahk\n+++ /dev/null\n@@ -1,93 +0,0 @@\n-#SingleInstance Force\n-\n-; You can generate a fresh version of this file with \"komorebic ahk-library\"\n-#Include %A_ScriptDir%\\komorebic.lib.ahk\n-; https://github.com/LGUG2Z/komorebi/#generating-common-application-specific-configurations\n-#Include %A_ScriptDir%\\komorebi.generated.ahk\n-\n-; Default to minimizing windows when switching workspaces\n-WindowHidingBehaviour(\"minimize\")\n-\n-; Set cross-monitor move behaviour to insert instead of swap\n-CrossMonitorMoveBehaviour(\"insert\")\n-\n-; Enable hot reloading of changes to this file\n-WatchConfiguration(\"enable\")\n-\n-; Ensure there is 1 workspace created on monitor 0\n-EnsureWorkspaces(0, 1)\n-\n-; Configure the invisible border dimensions\n-InvisibleBorders(7, 0, 14, 7)\n-\n-; Configure the 1st workspace\n-WorkspaceName(0, 0, \"I\")\n-\n-; Uncomment the next two lines if you want a visual border drawn around the focused window\n-; ActiveWindowBorderColour(66, 165, 245, \"single\") ; this is a nice blue colour\n-; ActiveWindowBorder(\"enable\")\n-\n-; Allow komorebi to start managing windows\n-CompleteConfiguration()\n-\n-; Change the focused window, Alt + Vim direction keys (HJKL)\n-!h::\n-Focus(\"left\")\n-return\n-\n-!j::\n-Focus(\"down\")\n-return\n-\n-!k::\n-Focus(\"up\")\n-return\n-\n-!l::\n-Focus(\"right\")\n-return\n-\n-; Move the focused window in a given direction, Alt + Shift + Vim direction keys (HJKL)\n-!+h::\n-Move(\"left\")\n-return\n-\n-!+j::\n-Move(\"down\")\n-return\n-\n-!+k::\n-Move(\"up\")\n-return\n-\n-!+l::\n-Move(\"right\")\n-return\n-\n-; There are many more commands that you can bind to whatever keys combinations you want!\n-;\n-; Have a look at the komorebic.lib.ahk file to see which arguments are required by different commands\n-;\n-; If you want more information about a command, you can run every komorebic command with \"--help\"\n-;\n-; For example, if you see this in komorebic.lib.ahk\n-;\n-; WorkspaceLayout(monitor, workspace, value) {\n-;    Run, komorebic.exe workspace-layout %monitor% %workspace% %value%, , Hide\n-; }\n-;\n-; Just run \"komorebic.exe workspace-layout --help\" and you'll get all the information you need to use the command\n-;\n-; komorebic.exe-workspace-layout\n-; Set the layout for the specified workspace\n-;\n-; USAGE:\n-;    komorebic.exe workspace-layout <MONITOR> <WORKSPACE> <VALUE>\n-;\n-; ARGS:\n-;    <MONITOR>      Monitor index (zero-indexed)\n-;    <WORKSPACE>    Workspace index on the specified monitor (zero-indexed)\n-;    <VALUE>        [possible values: bsp, columns, rows, vertical-stack, horizontal-stack, ultrawide-vertical-stack]\n-;\n-; OPTIONS:\n-;    -h, --help    Print help information\ndiff --git /dev/null b/komorebi.sample.ps1\nnew file mode 100644\n--- /dev/null\n+++ b/komorebi.sample.ps1\n@@ -0,0 +1,42 @@\n+if (!(Get-Process whkd -ErrorAction SilentlyContinue))\n+{\n+    Start-Process whkd -WindowStyle hidden\n+}\n+\n+. $PSScriptRoot\\komorebi.generated.ps1\n+\n+# Send the ALT key whenever changing focus to force focus changes\n+komorebic alt-focus-hack enable\n+# Default to minimizing windows when switching workspaces\n+komorebic window-hiding-behaviour cloak\n+# Set cross-monitor move behaviour to insert instead of swap\n+komorebic cross-monitor-move-behaviour insert\n+# Enable hot reloading of changes to this file\n+komorebic watch-configuration enable\n+\n+# create named workspaces I-V on monitor 0\n+komorebic ensure-named-workspaces 0 I II III IV V\n+# you can do the same thing for secondary monitors too\n+# komorebic ensure-named-workspaces 1 A B C D E F\n+\n+# assign layouts to workspaces, possible values: bsp, columns, rows, vertical-stack, horizontal-stack, ultrawide-vertical-stack\n+komorebic named-workspace-layout I bsp\n+\n+# set the gaps around the edge of the screen for a workspace\n+komorebic named-workspace-padding I 20\n+\n+# set the gaps between the containers for a workspace\n+komorebic named-workspace-container-padding I 20\n+\n+# you can assign specific apps to named workspaces\n+# komorebic named-workspace-rule exe \"Firefox.exe\" III\n+\n+# Configure the invisible border dimensions\n+komorebic invisible-borders 7 0 14 7\n+\n+# Uncomment the next lines if you want a visual border around the active window\n+# komorebic active-window-border-colour 66 165 245 --window-kind single\n+# komorebic active-window-border-colour 256 165 66 --window-kind stack\n+# komorebic active-window-border enable\n+\n+komorebic complete-configuration\n\\ No newline at end of file\ndiff --git a/komorebi/src/main.rs b/komorebi/src/main.rs\n--- a/komorebi/src/main.rs\n+++ b/komorebi/src/main.rs\n@@ -129,29 +129,17 @@ lazy_static! {\n         })\n     };\n     static ref DATA_DIR: PathBuf = dirs::data_local_dir().expect(\"there is no local data directory\").join(\"komorebi\");\n-    static ref AHK_V1_EXE: String = {\n-        let mut ahk_v1: String = String::from(\"autohotkey.exe\");\n+    static ref AHK_EXE: String = {\n+        let mut ahk: String = String::from(\"autohotkey.exe\");\n \n-        if let Ok(komorebi_ahk_v1_exe) = std::env::var(\"KOMOREBI_AHK_V1_EXE\") {\n-            if which(&komorebi_ahk_v1_exe).is_ok() {\n-                ahk_v1 = komorebi_ahk_v1_exe;\n+        if let Ok(komorebi_ahk_exe) = std::env::var(\"KOMOREBI_AHK_EXE\") {\n+            if which(&komorebi_ahk_exe).is_ok() {\n+                ahk = komorebi_ahk_exe;\n             }\n         }\n \n-        ahk_v1\n+        ahk\n     };\n-    static ref AHK_V2_EXE: String = {\n-        let mut ahk_v2: String = String::from(\"AutoHotkey64.exe\");\n-\n-        if let Ok(komorebi_ahk_v2_exe) = std::env::var(\"KOMOREBI_AHK_V2_EXE\") {\n-            if which(&komorebi_ahk_v2_exe).is_ok() {\n-                ahk_v2 = komorebi_ahk_v2_exe;\n-            }\n-        }\n-\n-        ahk_v2\n-    };\n-\n     static ref WINDOWS_11: bool = {\n         matches!(\n             os_info::get().version(),\ndiff --git a/komorebi/src/main.rs b/komorebi/src/main.rs\n--- a/komorebi/src/main.rs\n+++ b/komorebi/src/main.rs\n@@ -248,35 +236,41 @@ fn setup() -> Result<(WorkerGuard, WorkerGuard)> {\n pub fn load_configuration() -> Result<()> {\n     let home = HOME_DIR.clone();\n \n-    let mut config_v1 = home.clone();\n-    config_v1.push(\"komorebi.ahk\");\n+    let mut config_pwsh = home.clone();\n+    config_pwsh.push(\"komorebi.ps1\");\n+\n+    let mut config_ahk = home.clone();\n+    config_ahk.push(\"komorebi.ahk\");\n \n-    let mut config_v2 = home;\n-    config_v2.push(\"komorebi.ahk2\");\n+    if config_pwsh.exists() {\n+        let powershell_exe = if which(\"pwsh.exe\").is_ok() {\n+            \"pwsh.exe\"\n+        } else {\n+            \"powershell.exe\"\n+        };\n \n-    if config_v1.exists() && which(&*AHK_V1_EXE).is_ok() {\n         tracing::info!(\n             \"loading configuration file: {}\",\n-            config_v1\n+            config_pwsh\n                 .as_os_str()\n                 .to_str()\n                 .ok_or_else(|| anyhow!(\"cannot convert path to string\"))?\n         );\n \n-        Command::new(\"autohotkey.exe\")\n-            .arg(config_v1.as_os_str())\n+        Command::new(powershell_exe)\n+            .arg(config_pwsh.as_os_str())\n             .output()?;\n-    } else if config_v2.exists() && which(&*AHK_V2_EXE).is_ok() {\n+    } else if config_ahk.exists() && which(&*AHK_EXE).is_ok() {\n         tracing::info!(\n             \"loading configuration file: {}\",\n-            config_v2\n+            config_ahk\n                 .as_os_str()\n                 .to_str()\n                 .ok_or_else(|| anyhow!(\"cannot convert path to string\"))?\n         );\n \n-        Command::new(\"AutoHotkey64.exe\")\n-            .arg(config_v2.as_os_str())\n+        Command::new(\"autohotkey.exe\")\n+            .arg(config_ahk.as_os_str())\n             .output()?;\n     }\n \ndiff --git a/komorebi/src/window_manager.rs b/komorebi/src/window_manager.rs\n--- a/komorebi/src/window_manager.rs\n+++ b/komorebi/src/window_manager.rs\n@@ -230,16 +230,16 @@ impl WindowManager {\n     pub fn watch_configuration(&mut self, enable: bool) -> Result<()> {\n         let home = HOME_DIR.clone();\n \n-        let mut config_v1 = home.clone();\n-        config_v1.push(\"komorebi.ahk\");\n+        let mut config_pwsh = home.clone();\n+        config_pwsh.push(\"komorebi.ps1\");\n \n-        let mut config_v2 = home;\n-        config_v2.push(\"komorebi.ahk2\");\n+        let mut config_ahk = home.clone();\n+        config_ahk.push(\"komorebi.ahk\");\n \n-        if config_v1.exists() {\n-            self.configure_watcher(enable, config_v1)?;\n-        } else if config_v2.exists() {\n-            self.configure_watcher(enable, config_v2)?;\n+        if config_pwsh.exists() {\n+            self.configure_watcher(enable, config_pwsh)?;\n+        } else if config_ahk.exists() {\n+            self.configure_watcher(enable, config_ahk)?;\n         }\n \n         Ok(())\ndiff --git a/komorebic.lib.ahk /dev/null\n--- a/komorebic.lib.ahk\n+++ /dev/null\n@@ -1,441 +0,0 @@\n-; Generated by komorebic.exe\n-\n-Start(ffm, await_configuration, tcp_port) {\n-    RunWait, komorebic.exe start %ffm% --await-configuration %await_configuration% --tcp-port %tcp_port%, , Hide\n-}\n-\n-Stop() {\n-    RunWait, komorebic.exe stop, , Hide\n-}\n-\n-State() {\n-    RunWait, komorebic.exe state, , Hide\n-}\n-\n-Query(state_query) {\n-    RunWait, komorebic.exe query %state_query%, , Hide\n-}\n-\n-Subscribe(named_pipe) {\n-    RunWait, komorebic.exe subscribe %named_pipe%, , Hide\n-}\n-\n-Unsubscribe(named_pipe) {\n-    RunWait, komorebic.exe unsubscribe %named_pipe%, , Hide\n-}\n-\n-Log() {\n-    RunWait, komorebic.exe log, , Hide\n-}\n-\n-QuickSaveResize() {\n-    RunWait, komorebic.exe quick-save-resize, , Hide\n-}\n-\n-QuickLoadResize() {\n-    RunWait, komorebic.exe quick-load-resize, , Hide\n-}\n-\n-SaveResize(path) {\n-    RunWait, komorebic.exe save-resize %path%, , Hide\n-}\n-\n-LoadResize(path) {\n-    RunWait, komorebic.exe load-resize %path%, , Hide\n-}\n-\n-Focus(operation_direction) {\n-    RunWait, komorebic.exe focus %operation_direction%, , Hide\n-}\n-\n-Move(operation_direction) {\n-    RunWait, komorebic.exe move %operation_direction%, , Hide\n-}\n-\n-Minimize() {\n-    RunWait, komorebic.exe minimize, , Hide\n-}\n-\n-Close() {\n-    RunWait, komorebic.exe close, , Hide\n-}\n-\n-ForceFocus() {\n-    RunWait, komorebic.exe force-focus, , Hide\n-}\n-\n-CycleFocus(cycle_direction) {\n-    RunWait, komorebic.exe cycle-focus %cycle_direction%, , Hide\n-}\n-\n-CycleMove(cycle_direction) {\n-    RunWait, komorebic.exe cycle-move %cycle_direction%, , Hide\n-}\n-\n-Stack(operation_direction) {\n-    RunWait, komorebic.exe stack %operation_direction%, , Hide\n-}\n-\n-Resize(edge, sizing) {\n-    RunWait, komorebic.exe resize %edge% %sizing%, , Hide\n-}\n-\n-ResizeAxis(axis, sizing) {\n-    RunWait, komorebic.exe resize-axis %axis% %sizing%, , Hide\n-}\n-\n-Unstack() {\n-    RunWait, komorebic.exe unstack, , Hide\n-}\n-\n-CycleStack(cycle_direction) {\n-    RunWait, komorebic.exe cycle-stack %cycle_direction%, , Hide\n-}\n-\n-MoveToMonitor(target) {\n-    RunWait, komorebic.exe move-to-monitor %target%, , Hide\n-}\n-\n-MoveToWorkspace(target) {\n-    RunWait, komorebic.exe move-to-workspace %target%, , Hide\n-}\n-\n-MoveToNamedWorkspace(workspace) {\n-    RunWait, komorebic.exe move-to-named-workspace %workspace%, , Hide\n-}\n-\n-CycleMoveToWorkspace(cycle_direction) {\n-    RunWait, komorebic.exe cycle-move-to-workspace %cycle_direction%, , Hide\n-}\n-\n-SendToMonitor(target) {\n-    RunWait, komorebic.exe send-to-monitor %target%, , Hide\n-}\n-\n-SendToWorkspace(target) {\n-    RunWait, komorebic.exe send-to-workspace %target%, , Hide\n-}\n-\n-SendToNamedWorkspace(workspace) {\n-    RunWait, komorebic.exe send-to-named-workspace %workspace%, , Hide\n-}\n-\n-CycleSendToWorkspace(cycle_direction) {\n-    RunWait, komorebic.exe cycle-send-to-workspace %cycle_direction%, , Hide\n-}\n-\n-SendToMonitorWorkspace(target_monitor, target_workspace) {\n-    RunWait, komorebic.exe send-to-monitor-workspace %target_monitor% %target_workspace%, , Hide\n-}\n-\n-FocusMonitor(target) {\n-    RunWait, komorebic.exe focus-monitor %target%, , Hide\n-}\n-\n-FocusWorkspace(target) {\n-    RunWait, komorebic.exe focus-workspace %target%, , Hide\n-}\n-\n-FocusMonitorWorkspace(target_monitor, target_workspace) {\n-    RunWait, komorebic.exe focus-monitor-workspace %target_monitor% %target_workspace%, , Hide\n-}\n-\n-FocusNamedWorkspace(workspace) {\n-    RunWait, komorebic.exe focus-named-workspace %workspace%, , Hide\n-}\n-\n-CycleMonitor(cycle_direction) {\n-    RunWait, komorebic.exe cycle-monitor %cycle_direction%, , Hide\n-}\n-\n-CycleWorkspace(cycle_direction) {\n-    RunWait, komorebic.exe cycle-workspace %cycle_direction%, , Hide\n-}\n-\n-MoveWorkspaceToMonitor(target) {\n-    RunWait, komorebic.exe move-workspace-to-monitor %target%, , Hide\n-}\n-\n-NewWorkspace() {\n-    RunWait, komorebic.exe new-workspace, , Hide\n-}\n-\n-ResizeDelta(pixels) {\n-    RunWait, komorebic.exe resize-delta %pixels%, , Hide\n-}\n-\n-InvisibleBorders(left, top, right, bottom) {\n-    RunWait, komorebic.exe invisible-borders %left% %top% %right% %bottom%, , Hide\n-}\n-\n-GlobalWorkAreaOffset(left, top, right, bottom) {\n-    RunWait, komorebic.exe global-work-area-offset %left% %top% %right% %bottom%, , Hide\n-}\n-\n-MonitorWorkAreaOffset(monitor, left, top, right, bottom) {\n-    RunWait, komorebic.exe monitor-work-area-offset %monitor% %left% %top% %right% %bottom%, , Hide\n-}\n-\n-AdjustContainerPadding(sizing, adjustment) {\n-    RunWait, komorebic.exe adjust-container-padding %sizing% %adjustment%, , Hide\n-}\n-\n-AdjustWorkspacePadding(sizing, adjustment) {\n-    RunWait, komorebic.exe adjust-workspace-padding %sizing% %adjustment%, , Hide\n-}\n-\n-ChangeLayout(default_layout) {\n-    RunWait, komorebic.exe change-layout %default_layout%, , Hide\n-}\n-\n-LoadCustomLayout(path) {\n-    RunWait, komorebic.exe load-custom-layout %path%, , Hide\n-}\n-\n-FlipLayout(axis) {\n-    RunWait, komorebic.exe flip-layout %axis%, , Hide\n-}\n-\n-Promote() {\n-    RunWait, komorebic.exe promote, , Hide\n-}\n-\n-PromoteFocus() {\n-    RunWait, komorebic.exe promote-focus, , Hide\n-}\n-\n-Retile() {\n-    RunWait, komorebic.exe retile, , Hide\n-}\n-\n-MonitorIndexPreference(index_preference, left, top, right, bottom) {\n-    RunWait, komorebic.exe monitor-index-preference %index_preference% %left% %top% %right% %bottom%, , Hide\n-}\n-\n-EnsureWorkspaces(monitor, workspace_count) {\n-    RunWait, komorebic.exe ensure-workspaces %monitor% %workspace_count%, , Hide\n-}\n-\n-EnsureNamedWorkspaces(monitor, names) {\n-    RunWait, komorebic.exe ensure-named-workspaces %monitor% %names%, , Hide\n-}\n-\n-ContainerPadding(monitor, workspace, size) {\n-    RunWait, komorebic.exe container-padding %monitor% %workspace% %size%, , Hide\n-}\n-\n-NamedWorkspaceContainerPadding(workspace, size) {\n-    RunWait, komorebic.exe named-workspace-container-padding %workspace% %size%, , Hide\n-}\n-\n-WorkspacePadding(monitor, workspace, size) {\n-    RunWait, komorebic.exe workspace-padding %monitor% %workspace% %size%, , Hide\n-}\n-\n-NamedWorkspacePadding(workspace, size) {\n-    RunWait, komorebic.exe named-workspace-padding %workspace% %size%, , Hide\n-}\n-\n-WorkspaceLayout(monitor, workspace, value) {\n-    RunWait, komorebic.exe workspace-layout %monitor% %workspace% %value%, , Hide\n-}\n-\n-NamedWorkspaceLayout(workspace, value) {\n-    RunWait, komorebic.exe named-workspace-layout %workspace% %value%, , Hide\n-}\n-\n-WorkspaceCustomLayout(monitor, workspace, path) {\n-    RunWait, komorebic.exe workspace-custom-layout %monitor% %workspace% %path%, , Hide\n-}\n-\n-NamedWorkspaceCustomLayout(workspace, path) {\n-    RunWait, komorebic.exe named-workspace-custom-layout %workspace% %path%, , Hide\n-}\n-\n-WorkspaceLayoutRule(monitor, workspace, at_container_count, layout) {\n-    RunWait, komorebic.exe workspace-layout-rule %monitor% %workspace% %at_container_count% %layout%, , Hide\n-}\n-\n-NamedWorkspaceLayoutRule(workspace, at_container_count, layout) {\n-    RunWait, komorebic.exe named-workspace-layout-rule %workspace% %at_container_count% %layout%, , Hide\n-}\n-\n-WorkspaceCustomLayoutRule(monitor, workspace, at_container_count, path) {\n-    RunWait, komorebic.exe workspace-custom-layout-rule %monitor% %workspace% %at_container_count% %path%, , Hide\n-}\n-\n-NamedWorkspaceCustomLayoutRule(workspace, at_container_count, path) {\n-    RunWait, komorebic.exe named-workspace-custom-layout-rule %workspace% %at_container_count% %path%, , Hide\n-}\n-\n-ClearWorkspaceLayoutRules(monitor, workspace) {\n-    RunWait, komorebic.exe clear-workspace-layout-rules %monitor% %workspace%, , Hide\n-}\n-\n-ClearNamedWorkspaceLayoutRules(workspace) {\n-    RunWait, komorebic.exe clear-named-workspace-layout-rules %workspace%, , Hide\n-}\n-\n-WorkspaceTiling(monitor, workspace, value) {\n-    RunWait, komorebic.exe workspace-tiling %monitor% %workspace% %value%, , Hide\n-}\n-\n-NamedWorkspaceTiling(workspace, value) {\n-    RunWait, komorebic.exe named-workspace-tiling %workspace% %value%, , Hide\n-}\n-\n-WorkspaceName(monitor, workspace, value) {\n-    RunWait, komorebic.exe workspace-name %monitor% %workspace% %value%, , Hide\n-}\n-\n-ToggleWindowContainerBehaviour() {\n-    RunWait, komorebic.exe toggle-window-container-behaviour, , Hide\n-}\n-\n-TogglePause() {\n-    RunWait, komorebic.exe toggle-pause, , Hide\n-}\n-\n-ToggleTiling() {\n-    RunWait, komorebic.exe toggle-tiling, , Hide\n-}\n-\n-ToggleFloat() {\n-    RunWait, komorebic.exe toggle-float, , Hide\n-}\n-\n-ToggleMonocle() {\n-    RunWait, komorebic.exe toggle-monocle, , Hide\n-}\n-\n-ToggleMaximize() {\n-    RunWait, komorebic.exe toggle-maximize, , Hide\n-}\n-\n-RestoreWindows() {\n-    RunWait, komorebic.exe restore-windows, , Hide\n-}\n-\n-Manage() {\n-    RunWait, komorebic.exe manage, , Hide\n-}\n-\n-Unmanage() {\n-    RunWait, komorebic.exe unmanage, , Hide\n-}\n-\n-ReloadConfiguration() {\n-    RunWait, komorebic.exe reload-configuration, , Hide\n-}\n-\n-WatchConfiguration(boolean_state) {\n-    RunWait, komorebic.exe watch-configuration %boolean_state%, , Hide\n-}\n-\n-CompleteConfiguration() {\n-    RunWait, komorebic.exe complete-configuration, , Hide\n-}\n-\n-AltFocusHack(boolean_state) {\n-    RunWait, komorebic.exe alt-focus-hack %boolean_state%, , Hide\n-}\n-\n-WindowHidingBehaviour(hiding_behaviour) {\n-    RunWait, komorebic.exe window-hiding-behaviour %hiding_behaviour%, , Hide\n-}\n-\n-CrossMonitorMoveBehaviour(move_behaviour) {\n-    RunWait, komorebic.exe cross-monitor-move-behaviour %move_behaviour%, , Hide\n-}\n-\n-ToggleCrossMonitorMoveBehaviour() {\n-    RunWait, komorebic.exe toggle-cross-monitor-move-behaviour, , Hide\n-}\n-\n-UnmanagedWindowOperationBehaviour(operation_behaviour) {\n-    RunWait, komorebic.exe unmanaged-window-operation-behaviour %operation_behaviour%, , Hide\n-}\n-\n-FloatRule(identifier, id) {\n-    RunWait, komorebic.exe float-rule %identifier% \"%id%\", , Hide\n-}\n-\n-ManageRule(identifier, id) {\n-    RunWait, komorebic.exe manage-rule %identifier% \"%id%\", , Hide\n-}\n-\n-WorkspaceRule(identifier, id, monitor, workspace) {\n-    RunWait, komorebic.exe workspace-rule %identifier% \"%id%\" %monitor% %workspace%, , Hide\n-}\n-\n-NamedWorkspaceRule(identifier, id, workspace) {\n-    RunWait, komorebic.exe named-workspace-rule %identifier% \"%id%\" %workspace%, , Hide\n-}\n-\n-IdentifyObjectNameChangeApplication(identifier, id) {\n-    RunWait, komorebic.exe identify-object-name-change-application %identifier% \"%id%\", , Hide\n-}\n-\n-IdentifyTrayApplication(identifier, id) {\n-    RunWait, komorebic.exe identify-tray-application %identifier% \"%id%\", , Hide\n-}\n-\n-IdentifyLayeredApplication(identifier, id) {\n-    RunWait, komorebic.exe identify-layered-application %identifier% \"%id%\", , Hide\n-}\n-\n-IdentifyBorderOverflowApplication(identifier, id) {\n-    RunWait, komorebic.exe identify-border-overflow-application %identifier% \"%id%\", , Hide\n-}\n-\n-ActiveWindowBorder(boolean_state) {\n-    RunWait, komorebic.exe active-window-border %boolean_state%, , Hide\n-}\n-\n-ActiveWindowBorderColour(r, g, b, window_kind) {\n-    RunWait, komorebic.exe active-window-border-colour %r% %g% %b% --window-kind %window_kind%, , Hide\n-}\n-\n-ActiveWindowBorderWidth(width) {\n-    RunWait, komorebic.exe active-window-border-width %width%, , Hide\n-}\n-\n-ActiveWindowBorderOffset(offset) {\n-    RunWait, komorebic.exe active-window-border-offset %offset%, , Hide\n-}\n-\n-FocusFollowsMouse(boolean_state, implementation) {\n-    RunWait, komorebic.exe focus-follows-mouse %boolean_state% --implementation %implementation%, , Hide\n-}\n-\n-ToggleFocusFollowsMouse(implementation) {\n-    RunWait, komorebic.exe toggle-focus-follows-mouse  --implementation %implementation%, , Hide\n-}\n-\n-MouseFollowsFocus(boolean_state) {\n-    RunWait, komorebic.exe mouse-follows-focus %boolean_state%, , Hide\n-}\n-\n-ToggleMouseFollowsFocus() {\n-    RunWait, komorebic.exe toggle-mouse-follows-focus, , Hide\n-}\n-\n-AhkLibrary() {\n-    RunWait, komorebic.exe ahk-library, , Hide\n-}\n-\n-AhkAppSpecificConfiguration(path, override_path) {\n-    RunWait, komorebic.exe ahk-app-specific-configuration %path% %override_path%, , Hide\n-}\n-\n-FormatAppSpecificConfiguration(path) {\n-    RunWait, komorebic.exe format-app-specific-configuration %path%, , Hide\n-}\n-\n-NotificationSchema() {\n-    RunWait, komorebic.exe notification-schema, , Hide\n-}\n-\n-SocketSchema() {\n-    RunWait, komorebic.exe socket-schema, , Hide\n-}\n\\ No newline at end of file\ndiff --git a/komorebic/src/main.rs b/komorebic/src/main.rs\n--- a/komorebic/src/main.rs\n+++ b/komorebic/src/main.rs\n@@ -626,6 +626,14 @@ struct AhkAppSpecificConfiguration {\n     override_path: Option<String>,\n }\n \n+#[derive(Parser, AhkFunction)]\n+struct PwshAppSpecificConfiguration {\n+    /// YAML file from which the application-specific configurations should be loaded\n+    path: String,\n+    /// Optional YAML file of overrides to apply over the first file\n+    override_path: Option<String>,\n+}\n+\n #[derive(Parser, AhkFunction)]\n struct FormatAppSpecificConfiguration {\n     /// YAML file from which the application-specific configurations should be loaded\ndiff --git a/komorebic/src/main.rs b/komorebic/src/main.rs\n--- a/komorebic/src/main.rs\n+++ b/komorebic/src/main.rs\n@@ -948,6 +956,10 @@ enum SubCommand {\n     #[clap(arg_required_else_help = true)]\n     #[clap(alias = \"ahk-asc\")]\n     AhkAppSpecificConfiguration(AhkAppSpecificConfiguration),\n+    /// Generate common app-specific configurations and fixes in a PowerShell script\n+    #[clap(arg_required_else_help = true)]\n+    #[clap(alias = \"pwsh-asc\")]\n+    PwshAppSpecificConfiguration(PwshAppSpecificConfiguration),\n     /// Format a YAML file for use with the 'ahk-app-specific-configuration' command\n     #[clap(arg_required_else_help = true)]\n     #[clap(alias = \"fmt-asc\")]\ndiff --git a/komorebic/src/main.rs b/komorebic/src/main.rs\n--- a/komorebic/src/main.rs\n+++ b/komorebic/src/main.rs\n@@ -1264,6 +1276,8 @@ fn main() -> Result<()> {\n                 let stdout = String::from_utf8(output.stdout)?;\n                 match stdout.trim() {\n                     stdout if stdout.is_empty() => None,\n+                    // It's possible that a komorebi.ps1 config will be in %USERPROFILE% - ignore this\n+                    stdout if !stdout.contains(\"scoop\") => None,\n                     stdout => {\n                         buf = PathBuf::from(stdout);\n                         buf.pop(); // %USERPROFILE%\\scoop\\shims\ndiff --git a/komorebic/src/main.rs b/komorebic/src/main.rs\n--- a/komorebic/src/main.rs\n+++ b/komorebic/src/main.rs\n@@ -1692,6 +1706,37 @@ fn main() -> Result<()> {\n \n             println!(\"\\n#Include %A_ScriptDir%\\\\komorebi.generated.ahk\");\n         }\n+        SubCommand::PwshAppSpecificConfiguration(arg) => {\n+            let content = std::fs::read_to_string(resolve_windows_path(&arg.path)?)?;\n+            let lines = if let Some(override_path) = arg.override_path {\n+                let override_content =\n+                    std::fs::read_to_string(resolve_windows_path(&override_path)?)?;\n+\n+                ApplicationConfigurationGenerator::generate_pwsh(\n+                    &content,\n+                    Option::from(override_content.as_str()),\n+                )?\n+            } else {\n+                ApplicationConfigurationGenerator::generate_pwsh(&content, None)?\n+            };\n+\n+            let mut generated_config = HOME_DIR.clone();\n+            generated_config.push(\"komorebi.generated.ps1\");\n+            let mut file = OpenOptions::new()\n+                .write(true)\n+                .create(true)\n+                .truncate(true)\n+                .open(generated_config.clone())?;\n+\n+            file.write_all(lines.join(\"\\n\").as_bytes())?;\n+\n+            println!(\n+                \"\\nApplication-specific generated configuration written to {}\",\n+                generated_config.to_str().ok_or_else(|| anyhow!(\n+                    \"could not find the path to the generated configuration file\"\n+                ))?\n+            );\n+        }\n         SubCommand::FormatAppSpecificConfiguration(arg) => {\n             let file_path = resolve_windows_path(&arg.path)?;\n             let content = std::fs::read_to_string(&file_path)?;\ndiff --git /dev/null b/whkdrc.sample\nnew file mode 100644\n--- /dev/null\n+++ b/whkdrc.sample\n@@ -0,0 +1,64 @@\n+.shell pwsh\n+\n+# reload swhkd configuration\n+# alt + o                 : taskkill /f /im swhkd.exe && start /b swhkd # if shell is cmd\n+alt + o                 : taskkill /f /im swhkd.exe && Start-Process swhkd -WindowStyle hidden # if shell is pwsh / powershell\n+alt + shift + o         : komorebic reload-configuration\n+\n+# app shortcuts - these require shell to be pwsh / powershell\n+# the apps will be focused if open, or launched if not open\n+# alt + f                 : if ($wshell.AppActivate('Firefox') -eq $False) { start firefox }\n+# alt + b                 : if ($wshell.AppActivate('Chrome') -eq $False) { start chrome }\n+\n+# focus windows\n+alt + h                 : komorebic focus left\n+alt + j                 : komorebic focus down\n+alt + k                 : komorebic focus up\n+alt + l                 : komorebic focus right\n+alt + shift + oem_4     : komorebic cycle-focus previous # oem_4 is [\n+alt + shift + oem_6     : komorebic cycle-focus next # oem_6 is ]\n+\n+# move windows\n+alt + shift + h         : komorebic move left\n+alt + shift + j         : komorebic move down\n+alt + shift + k         : komorebic move up\n+alt + shift + l         : komorebic move right\n+alt + shift + return    : komorebic promote\n+\n+# stack windows\n+alt + left              : komorebic stack left\n+alt + down              : komorebic stack down\n+alt + up                : komorebic stack up\n+alt + right             : komorebic stack right\n+alt + oem_1             : komorebic unstack # oem_1 is ;\n+alt + oem_4             : komorebic cycle-stack previous # oem_4 is [\n+alt + oem_6             : komorebic cycle-stack next # oem_6 is ]\n+\n+# resize\n+alt + oem_plus          : komorebic resize-axis horizontal increase\n+alt + oem_minus         : komorebic resize-axis horizontal decrease\n+alt + shift + oem_plus  : komorebic resize-axis vertical increase\n+alt + shift + oem_minus : komorebic resize-axis vertical decrease\n+\n+# manipulate windows\n+alt + t                 : komorebic toggle-float\n+alt + shift + f         : komorebic toggle-monocle\n+\n+# window manager options\n+alt + shift + r         : komorebic retile\n+alt + p                 : komorebic toggle-pause\n+alt + 0                 : komorebic toggle-focus-follows-mouse\n+\n+# layouts\n+alt + x                 : komorebic flip-layout horizontal\n+alt + y                 : komorebic flip-layout vertical\n+\n+# workspaces\n+alt + 1                 : komorebic focus-workspace 0\n+alt + 2                 : komorebic focus-workspace 1\n+alt + 3                 : komorebic focus-workspace 2\n+\n+# move windows across workspaces\n+alt + shift + 1         : komorebic move-to-workspace 0\n+alt + shift + 2         : komorebic move-to-workspace 1\n+alt + shift + 3         : komorebic move-to-workspace 2\n",
        "test_patch": "diff --git a/README.md b/README.md\n--- a/README.md\n+++ b/README.md\n@@ -138,43 +158,50 @@ This means that:\n \n ## Getting Started\n \n-### GitHub Releases\n+### Quickstart\n \n-Prebuilt binaries are available on the [releases page](https://github.com/LGUG2Z/komorebi/releases) in a `zip` archive.\n-Once downloaded, you will need to move the `komorebi.exe` and `komorebic.exe` binaries to a directory in your `Path` (\n-you can see these directories by running `$Env:Path.split(\";\")` at a PowerShell prompt).\n+Make sure that you have either the [Scoop Package Manager](https://scoop.sh) or WinGet installed, then run the following\n+commands at a PowerShell prompt.\n \n-Alternatively, you may add a new directory to your `Path`\n-using [`setx`](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/setx) or the Environment\n-Variables pop up in System Properties Advanced (which can be launched with `SystemPropertiesAdvanced.exe` at a\n-PowerShell prompt), and then move the binaries to that directory.\n+```powershell\n+# if using scoop\n+scoop bucket add extras\n+scoop install whkd\n+scoop install komorebi\n \n-### Winget\n+# if using winget\n+winget install LGUG2Z.whkd\n+winget install LGUG2Z.komorebi\n \n-You can use the builtin package manager from Windows to install the latest komorebi release:\n+# save the latest generated app-specific config tweaks and fixes to ~/komorebi.generated.ps1\n+iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/komorebi.generated.ps1 -OutFile $Env:USERPROFILE\\komorebi.generated.ps1\n \n-```powershell\n-winget install LGUG2Z.komorebi\n-```\n+# save the sample komorebi configuration file to ~/komorebi.ps1\n+iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/komorebi.sample.ps1 -OutFile $Env:USERPROFILE\\komorebi.ps1\n \n-### Scoop\n+# ensure the ~/.config folder exists\n+mkdir $Env:USERPROFILE\\.config -ea 0\n \n-If you use the [Scoop](https://scoop.sh/) command line installer, you can run the following commands to install the\n-binaries from the latest GitHub Release:\n+# save the sample whkdrc file with key bindings to ~/.config/whkdrc\n+iwr https://raw.githubusercontent.com/LGUG2Z/komorebi/master/whkdrc -OutFile $Env:USERPROFILE\\whkdrc\n \n-```powershell\n-scoop bucket add extras\n-scoop install komorebi\n+# start komorebi\n+komorebic start --await-configuration\n ```\n \n-If you install _komorebi_ using Scoop, the binaries will automatically be added to your `Path`.\n+Thanks to [@sitiom](https://github.com/sitiom) for getting _komorebi_ added to both the popular Scoop Extras bucket and\n+to WinGet.\n \n-Thanks to [@sitiom](https://github.com/sitiom) for getting _komorebi_ added to the popular Scoop Extras bucket.\n+### GitHub Releases\n+\n+Prebuilt binaries are available on the [releases page](https://github.com/LGUG2Z/komorebi/releases) in a `zip` archive.\n+Once downloaded, you will need to move the `komorebi.exe` and `komorebic.exe` binaries to a directory in your `Path` (\n+you can see these directories by running `$Env:Path.split(\";\")` at a PowerShell prompt).\n \n ### Building from Source\n \n If you prefer to compile _komorebi_ from source, you will need\n-a [working Rust development environment on Windows 10](https://rustup.rs/). The `x86_64-pc-windows-msvc` toolchain is\n+a [working Rust development environment on Windows 10/11](https://rustup.rs/). The `x86_64-pc-windows-msvc` toolchain is\n required, so make sure you have also installed\n the [Build Tools for Visual Studio 2019](https://stackoverflow.com/a/55603112).\n \n",
        "problem_statement": "[FEAT]: Use Autohotkey v2 by default\n**Is your feature request related to a problem? Please describe.**\r\nSince Autohotkey v2 [has reached stable](https://github.com/AutoHotkey/AutoHotkey/releases/tag/v2.0.0), it might be a good time to migrate completely to v2.\r\n\r\n**Describe the solution you'd like**\r\n\r\nMake komorebi use AutoHotkey v2 by default. To do that:\r\n- Migrate the sample config, helper library, and `ahk-asc` to v2\r\n- Generate v2 syntax by default. For compatibility with v1, add a flag in the `ahk-library` and `ahk-asc` commands to generate v1 syntax instead.\r\n- Merge `$Env:KOMOREBI_AHK_V1_EXE` and `$Env:KOMOREBI_AHK_V2_EXE` to a single `$Env:KOMOREBI_AHK_EXE` (either v1 or v2).\r\n- Remove `.ahk2` and just have a single `komorebi.ahk` file (either v1 or v2). Autohotkey v2 has a [launcher](https://www.autohotkey.com/docs/v2/Program.htm#launcher-cmd) [script](https://www.autohotkey.com/docs/v2/Program.htm#launcher) where it can detect the version of the running script and run the appropriate interpreter for it.\r\n![image](https://user-images.githubusercontent.com/56180050/209056149-9e1adbbd-a3ef-43d7-bb78-350ae63b0327.png)\r\nThe behavior can be configured in the settings:\r\n![image](https://user-images.githubusercontent.com/56180050/209055066-393cc118-531e-450b-9d32-609536b807aa.png)\r\nIt would be good for komorebi to make use of it.\r\n\r\n**Describe alternatives you've considered**\r\nNone.\r\n\r\n**Additional context**\r\nRelated to #10\r\n\n",
        "hints_text": "There are some significant changes in AHK2 syntax which require commands to `Run` and `RunWait` to be surrounded by single (or maybe double?) quotes. Unfortunately I have been unable to find a way to do string interpolation in AHK2 (eg. `command ${arg} --flag ${flag_arg}`). Without this, I can't see a way to generate (or even _have_) an AHK v2 library for `komorebic`.\r\n\r\nFor now new users should continue to install AHK v1.1 from the Scoop `versions` bucket if they want to play around with the sample configurations in this repo.\r\n\r\nI will be traveling for most of this month (without a Windows laptop) so I won't be able to do much coding, but if someone can figure out how to handle string interpolation (in any position, not just prepending or appending) in AHK v2, please share the details in this issue.\nFrom the [docs](https://www.autohotkey.com/docs/v2/Variables.htm):\r\n\r\n> **Retrieving the contents of variables:** To include the contents of a variable in a string, use [concatenation](https://www.autohotkey.com/docs/v2/Variables.htm#concat) or [Format](https://www.autohotkey.com/docs/v2/lib/Format.htm). For example:\r\n> ```ahk\r\n> MsgBox \"The value of Var is \" . Var . \".\"\r\n> MsgBox \"The value in the variable named Var is \" Var \".\"\r\n> MsgBox Format(\"Var has the value {1}.\", Var)\r\n> ```\r\n>\r\n> Sub-expressions can be combined with strings in the same way. For example:\r\n\r\n> ```ahk\r\n> MsgBox(\"The sum of X and Y is \" . (X + Y))\r\n> ```\nI've been able to use the `format` AHK fn with variadic args collected into an array to update the code here:\r\n\r\nhttps://github.com/LGUG2Z/komorebi/blob/master/derive-ahk/src/lib.rs#L151\r\n\r\nHowever, this doesn't work consistently, and it completely falls apart when generating trying to generate library functions for commands that require flags:\r\n\r\nhttps://github.com/LGUG2Z/komorebi/blob/master/derive-ahk/src/lib.rs#L132\r\n\r\nI have considered just dropping the library altogether and providing a single wrapper command like this:\r\n\r\n```ahk\r\nKomorebi(cmd) {\r\n  RunWait(format(\"komorebic.exe {}\", cmd), , \"Hide\")\r\n}\r\n\r\n; usage\r\nKomorebi(\"window-hiding-behaviour minimize\")\r\n\r\n; Change the focused window, Alt + Vim direction keys\r\n!h::\r\n{\r\n  Komorebi(\"focus left\")\r\n}\r\n\r\n```\r\n\r\nThis works well enough, however when running with an ahk2 interpreter, the focus commands produce access denied errors in `komorebi` which I am unable to reproduce with either ahk1.1 or just by running the commands in the terminal:\r\n\r\n```\r\n2023-01-19T15:11:13.688842Z ERROR process_command{FocusWindow(Right)}:focus_container_in_direction{direction=Right}: komorebi::window: could not set as foreground window, but continuing execution of focus(): The operation completed successfully. (0x00000000)\r\n2023-01-19T15:11:13.689414Z ERROR komorebi::process_command: Access is denied. (0x80070005)\r\n```\r\n\r\nIs anyone else using ahk2 experiencing this issue when trying to change window focus?",
        "created_at": "2023-02-19T15:42:53Z"
    }
]